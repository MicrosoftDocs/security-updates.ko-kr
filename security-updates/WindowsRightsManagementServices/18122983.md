---
TOCTitle: RMS 관리 문제
Title: RMS 관리 문제
ms:assetid: '97013c08-d3fa-4ea0-8914-995b6c97f900'
ms:contentKeyID: 18122983
ms:mtpsurl: 'https://technet.microsoft.com/ko-kr/library/Cc747605(v=WS.10)'
---

RMS 관리 문제
=============

RMS를 서버에 성공적으로 구축한 후 일상적인 RMS 관리 중에 문제가 발생할 수 있습니다. 다음 섹션의 정보를 사용하여 이러한 문제를 해결할 수 있습니다.

RMS 관리 웹 사이트를 열려고 시도하면 "SQL Server가 없거나 액세스가 거부되었습니다."라는 메시지가 표시됩니다.
------------------------------------------------------------------------------------------------------------

SQL Server 2005의 새 설치를 데이터베이스 서버로 사용하여 RMS를 설치한 경우 SQL Server 서비스가 시작되지 않을 수 있습니다. SQL Server 2005에서 MSSQLSERVER 서비스는 서버를 시작할 때 자동으로 시작하도록 구성되어 있지 않습니다. RMS를 설치한 후 SQL Server를 다시 시작했고 이 서비스가 자동으로 다시 시작하도록 구성하지 않은 경우 RMS는 작동하지 않고 RMS 글로벌 관리 페이지만 액세스할 수 있습니다.

MSSQLSERVER 서비스를 시작한 후 RMS 서버에서 IIS를 다시 시작하여 RMS 기능을 복원해야 합니다.

오프라인 등록 프로세스를 완료할 수 없습니다.
--------------------------------------------

등록 요청 파일을 EnrollService 웹 사이트로 전송하기 전에 파일을 완료하지 않았거나 수정한 경우 오프라인 등록을 완료할 수 없습니다. 악의적인 프로그램 , 사용자 오류 또는 시스템 오류로 인해 등록 요청 파일이 손상되었을 수 있습니다.

누락된 정보에 따라 EnrollService 웹 사이트는 파일을 수락하고 서버 사용 허가자 인증서를 반환할 수도 있고 요청 파일의 수락을 거부하고 오류를 나타낼 수도 있습니다.

서버 사용 허가자 인증서가 반환되는 경우 등록 요청 파일에 있는 누락 또는 손상이 반영되고 사용자가 인증서를 가져오려고 시도하면 RMS에 오류가 표시됩니다.

등록 프로세스를 완료할 수 없는 경우 인터넷에 연결된 컴퓨터가 바이러스에 감염되지 않았는지 확인하고 RMS 서버에서 등록 요청 파일을 다시 내보낸 다음 다른 미디어를 사용하여 인터넷에 연결된 컴퓨터로 전송합니다. 다시 오류가 발생하는 경우 Microsoft 기술 지원 서비스에 문의하십시오.

로그 파일이 만들어지지 않습니다.
--------------------------------

RMS 로깅 서비스는 메시지 큐(MSMQ라고도 함) 서비스가 필요하며 로깅 데이터베이스에 액세스해야 합니다. 로그 파일이 만들어지지 않는 경우 구성 요소가 제대로 구성되지 않았거나 구성 요소 간의 통신이 중단되었을 수 있습니다.

RMS 서버와 데이터베이스 서버가 네트워크에 연결되어 있는지 확인합니다. 연결되어 있는 경우 다음 절차에 따라 RMS 로깅 서비스에 대한 필수 구성 요소를 검토하고 모든 소프트웨어 종속성이 제대로 구성되어 있는지 확인합니다.

첫째, 메시지 큐의 구성이 올바른지 확인합니다. 메시지 큐는 Active Directory 통합을 사용하여 설치해야 합니다.

**메시지 큐가 제대로 설치되고 구성되었는지 확인하려면**
1.  **제어판**에서 **프로그램 추가/제거**를 클릭한 다음 **Windows 구성 요소 추가/제거**를 클릭하여 **Windows 구성 요소 마법사**를 엽니다.

2.  **Windows 구성 요소 마법사**에서 **응용 프로그램 서버** 확인란을 선택한 다음 **자세히**를 클릭합니다.

3.  **메시지 큐** 확인란을 선택한 다음 **자세히**를 클릭합니다.

4.  **Active Directory 통합** 확인란이 선택되어 있는 경우 다음 테스트로 이동하여 메시지 큐가 실행 중인지 확인합니다. 확인란이 선택되어 있지 않은 경우 5단계에서 9단계까지를 계속 수행합니다.

5.  **시작**을 클릭하고 **모든 프로그램**과 **Windows RMS**를 차례로 가리킨 다음 **Windows RMS 관리**를 클릭하여 글로벌 관리 페이지를 엽니다.

6.  RMS가 제공되는 웹 사이트 옆에 있는 **이 웹 사이트에서 RMS 제거**를 클릭한 다음, **확인**을 클릭합니다.

7.  **제어판**의 **프로그램 추가/제거**에서 **Windows 구성 요소 추가/제거**, **응용 프로그램 서버**를 차례로 클릭한 다음 **메시지 큐**를 클릭합니다.

8.  **Active Directory 통합**을 사용하려면 **자세히**를 클릭하고 **Active Directory 통합** 확인란을 선택한 다음 **확인**을 클릭합니다.

9.  **글로벌 관리 페이지**를 엽니다. RMS를 구축할 웹 사이트의 이름 옆에 있는 **이 웹 사이트에 RMS 구축**을 클릭합니다.

둘째, 메시지 큐가 서버에서 실행 중인지 확인합니다.

**메시지 큐가 서버에서 실행 중인지 확인하려면**
1.  **제어판**에서 **관리 도구**를 클릭한 다음 **서비스**를 클릭합니다.

2.  서비스 목록을 아래로 스크롤하여 **메시지 큐** 서비스를 찾습니다.

3.  **상태** 열에 서비스가 **시작됨**으로 보고되어야 합니다. 그렇지 않은 경우 서비스를 마우스 오른쪽 단추로 클릭한 다음 **시작**을 클릭합니다.

셋째, 로깅 서비스에 로깅 데이터베이스에 대한 이벤트 쓰기 권한이 있는지 확인합니다. RMS 로깅 서비스는 RMS 서비스 계정을 사용하여 실행됩니다. RMS 서비스에 데이터베이스 서버에 대한 유효 로그인이 있고 데이터베이스를 만들고 파일에 정보를 쓰는 데 필요한 사용 권한이 부여되어 있는지 확인합니다.

이러한 모든 필수 구성 요소를 충족하는 경우 서비스 스냅인을 사용하여 RMS 로깅 서비스를 중지하였다가 다시 시작합니다. RMS 로깅 서비스가 다시 시작되면 로그 파일이 데이터베이스 서버에 만들어져야 합니다. SQL Server를 데이터베이스 서버로 사용하는 경우 다음 절차에 따라 로그 파일이 만들어지는지 확인합니다.

**로그 파일이 SQL Server에 만들어지는지 확인하려면**
1.  SQL Server 엔터프라이즈 관리자에서 로깅 데이터베이스로 이동하여 **데이터베이스**를 확장한 다음, RMS 로깅 데이터베이스가 포함된 데이터베이스를 확장합니다.

2.  로깅 데이터베이스, **Tables**를 차례로 클릭하고 **DRMS\_log\_master**를 마우스 오른쪽 단추로 클릭한 다음, **Open table ? return all rows**를 클릭합니다. 로그 파일이 만들어지고 있으면 하나 이상의 로그 파일이 보입니다.

구성 데이터베이스 복원
----------------------

RMS는 작동하는 구성 데이터베이스가 없을 경우 작동할 수 없습니다. 데이터베이스 서버에서 데이터베이스 손상 또는 하드 디스크 오류와 같은 구성 데이터베이스 문제가 발생할 경우 구성 데이터베이스의 백업을 복원하면 RMS 기능을 복원할 수 있습니다. 백업으로부터 RMS 구성 데이터베이스를 복원하려면 다음과 같은 정보가 필요합니다.

-   데이터베이스의 최신 백업 이름
-   백업 데이터베이스를 복원할 컴퓨터 이름
-   RMS를 처음 구축할 때 사용한 계정 이름과 암호
-   소프트웨어 개인 키 보호를 위해 처음 지정한 암호(사용한 경우)

RMS는 백업 구성 데이터베이스에서 가져온 모든 설정을 그대로 유지하기 때문에 백업 데이터베이스로부터 복원하기 위해 새로운 서버 사용 허가자 인증서나 새로운 개인 키가 필요하지 않습니다.

다음 절차에 따라 백업 데이터베이스를 복원할 수 있습니다.

**백업 데이터베이스를 복원하려면**
1.  **시작**을 클릭하고 **모든 프로그램**과 **Windows RMS**를 차례로 가리킨 다음 **Windows RMS 관리**를 클릭하여 **글로벌 관리** 페이지를 엽니다.

2.  RMS가 제공되는 웹 사이트 옆에 있는 **이 웹 사이트에서 RMS 제거**를 클릭한 다음, **확인**을 클릭합니다.

3.  구성 데이터베이스에 대한 백업 데이터베이스 파일을 복원합니다. 백업 절차를 수행하는 중에 로깅 데이터베이스를 백업한 경우 데이터의 연속성을 유지하려면 로깅 데이터베이스도 함께 복원합니다.

    -   전체 시스템에 오류가 생긴 후에 이 시스템을 복원하려면 시스템 상태 백업을 사용하여 레지스트리를 복원한 다음 백업 데이터베이스 파일을 복원합니다.

4.  복원할 데이터베이스가 단일 루트 인증 서버용인 경우 다음 레지스트리 키를 수정한 다음 서비스를 다시 구축합니다.

    -   32비트 버전의 Windows Server2003?을 실행하는 컴퓨터:
        `HKEY_LOCAL_MACHINE\Software\Microsoft\DRMS\1.0\`
    -   64비트 버전의 Windows Server2003?을 실행하는 컴퓨터:
        `HKEY_LOCAL_MACHINE\Software\WOW6432Node\Microsoft\DRMS\1.0\`

    다음 항목을 문자열 값으로 추가하고 값은 비워둡니다.

    `GicURL`

    그러면 루트 인증 서버의 Active Directory 검색이 무시되므로 루트 인증 서버 구축 페이지에 액세스할 수 있습니다.

5.  하드웨어 보안 모듈을 사용하여 RMS 개인 키를 보안한 경우 키가 검색될 수 있도록 백업 보안을 복원합니다.

6.  다음 단계 중 하나를 수행합니다.

    -   클러스터가 아닌 단일 서버의 데이터베이스를 복원하려면 RMS를 구축할 웹 사이트 옆에 있는 이 웹 사이트에 RMS 구축을 클릭합니다.
        -또는-
    -   클러스터의 데이터베이스를 복원하려면 RMS를 구축할 웹 사이트 옆에 있는 클러스터에 이 서버 추가를 클릭합니다.

7.  원래 서버를 제공(Provision)하는 데 사용한 RMS 서비스 계정을 지정합니다.

8.  사용할 백업 구성 데이터베이스(데이터베이스 이름과 데이터베이스가 있는 컴퓨터의 이름 포함)를 지정합니다.

9.  원래 이 서버를 제공(Provision)하는 데 사용한 것과 동일한 암호를 지정합니다.

10. **전송**을 클릭합니다.

구축 프로세스가 시작되고 RMS가 서버에 다시 구축됩니다.

자세한 내용은 이 설명서 모음의 RMS 배포 계획에서 시스템 복구 계획 및 RMS 시스템 백업 및 복원을 참조하십시오.

만료된 RMS 서비스 계정 암호
---------------------------

RMS 작동이 중지되는 경우 RMS 서비스 계정 암호가 만료되었을 수 있습니다. IIS 관리자에서 찾습니다. RMS 응용 프로그램 풀이 중지되고 다시 시작할 수 없는 경우 RMS 서비스 계정 암호가 만료되었을 수 있습니다.

RMS 서비스 계정 암호가 만료된 경우 만료된 암호를 가진 계정을 사용하는 각 RMS 서버에서 암호를 변경한 다음 IIS를 다시 시작해야 합니다. 자세한 내용은 이 설명서 모음의 "RMS 서버 운영"에 나오는 "RMS 서비스 계정 암호 변경"를 참조하십시오.

이전 RMS 설치 복원
------------------

RMS 서버 하드웨어 또는 소프트웨어에 오류가 생기는 경우 이전에 설치된 구성 데이터베이스로 새 서버 인스턴스를 구축하여 RMS 서버를 복원할 수 있습니다.

> [!NOTE]  
> 이 절차는 RMS를 실행 중인 서버에 오류가 생긴 경우에만 적용됩니다. 구성 데이터베이스를 실행 중인 서버에 오류가 생긴 경우에는 이 항목 앞부분의 "구성 데이터베이스 복원"을 참조하십시오. RMS 서버가 데이터베이스 서버이기도 한 경우 백업 복사본으로부터 전체 서버를 복원해야 합니다.

다음 절차에 따라 원본 설치에 사용된 것과 동일한 구성 데이터베이스를 가리킵니다.

**이전 RMS 설치를 복원하려면**
1.  관리 권한이 있는 계정을 사용하여 RMS 서버로 구성하려는 컴퓨터에 로그온합니다. 이 컴퓨터가 RMS에 대한 최소 시스템 요구 사항을 충족하는지 확인합니다. RMS 시스템 요구 사항에 대한 자세한 내용은 이 설명서 모음의 "RMS 배포 계획"에 나오는 "RMS 하드웨어 요구 사항"을 참조하십시오.

2.  하드웨어 보안 모듈을 사용하여 RMS 개인 키를 보호하는 경우 이전 RMS 설치에 사용된 것과 동일한 설정과 보안을 사용하여 제대로 구성되는지 확인합니다.

3.  컴퓨터에 RMS를 설치합니다.

4.  RMS 설치를 완료한 후 **시작**을 클릭하고 **모든 프로그램**과 **Windows RMS**를 차례로 가리킨 다음 **Windows RMS 관리**를 클릭하여 **글로벌 관리** 페이지를 엽니다.

5.  RMS를 구축할 웹 사이트 옆에 있는 **클러스터에 이 서버 추가**를 클릭합니다.

6.  **RMS 서비스 계정** 영역에서 대부분의 일반 작업에 대해 domain\_name\\user\_name 형식의 RMS 서비스 계정 이름과 RMS를 실행할 RMS 서비스 계정의 암호를 입력합니다. 이 계정은 도메인 계정이어야 합니다.

7.  **구성 데이터베이스** 영역에서 복구할 원본 RMS 설치에 대한 데이터베이스 서버 이름과 구성 데이터베이스 이름을 지정합니다.

8.  **개인 키 보호** 영역에서 개인 키를 보호하기 위해 이 클러스터에서 사용할 메커니즘을 선택합니다. 기본 소프트웨어 기반 개인 키 보호를 사용하는 경우 이 클러스터가 처음 구축되었을 때 개인 키 암호화에 사용한 암호를 제공해야 합니다.

9.  **전송**을 클릭합니다.

사용 권한이 만료되어 클라이언트가 RMS로 보호된 콘텐츠를 열 수 없습니다.
-----------------------------------------------------------------------

사용 권한이 만료된 사용자는 RMS로 보호된 콘텐츠를 사용할 수 없습니다. RMS 서버의 시스템 클럭이 RMS 클라이언트의 시스템 클럭보다 빠른 경우 사용 권한이 만료되지 않았더라도 RMS로 보호된 콘텐츠를 사용하지 못할 수 있습니다. 두 컴퓨터의 시스템 클럭이 동기화되지 않았기 때문에 클라이언트 컴퓨터에서 콘텐츠를 열 때 다음과 같은 오류 메시지가 표시될 수 있습니다.

**권한이 만료되었으므로 이 메시지를 열 권한이 없습니다. 다른 자격 증명으로 여시겠습니까?**

클라이언트 라이센스와 콘텐츠 라이센스가 모두 유효하지만 시간이 차이가 나기 때문에 클라이언트에서 콘텐츠 라이센스를 유효하지 않은 것으로 해석하여 이 오류를 사용자에게 반환합니다. 이로 인해 사용자는 자신의 RMS 계정 인증서나 문서에 부여된 권한에 문제가 발생한 것으로 믿게 될 수 있습니다. 클라이언트의 클럭이 콘텐츠 게시 라이센스의 유효 시간 범위에 도달한 경우 사용자는 콘텐츠를 열 수 있습니다.

RMS 시스템의 서버와 클라이언트를 동일한 시간 서비스로 동기화하는 것이 가장 좋습니다.

RMS에서 이벤트를 응용 프로그램 이벤트 로그에 기록할 때 "액세스가 거부되었습니다."라는 오류 메시지가 표시됩니다.
---------------------------------------------------------------------------------------------------------------

기본적으로 ASP 페이지에서 실행되는 RMS와 같은 구성 요소는 IUSR\_COMPUTERNAME 계정 아래에 만들어집니다. 이 계정은 Guests 그룹의 구성원이고 응용 프로그램 이벤트 로그에 쓰는 데 필요한 보안 권한으로 인해 Guest 계정에서 이벤트 로그에 데이터를 쓸 수 없습니다.

이 문제를 해결하려면 레지스트리 편집기를 사용하여 이 동작을 제어하는 레지스트리 키를 수정할 수 있습니다.

> [!CAUTION]  
> 레지스트리를 잘못 편집하면 시스템이 심하게 손상될 수 있습니다. 레지스트리를 변경하기 전에 컴퓨터에 있는 중요한 데이터를 백업해야 합니다.

다음 레지스트리 키를 1 대신 0으로 설정한 다음 컴퓨터를 다시 시작하여 변경 사항을 적용합니다.

`HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\EventLog\Application`

이름: `RestrictGuestAccess`

형식: `REG_DWORD`

> [!NOTE]  
> 그러면 모든 Guest 계정에서 응용 프로그램 이벤트 로그에 쓸 수 있습니다.

이 오류의 원인에 대한 자세한 내용은 [Microsoft 기술 자료](https://go.microsoft.com/fwlink/?linkid=44167의) ASP 페이지에서 로깅 사용 관련 문서를 참조하십시오.
