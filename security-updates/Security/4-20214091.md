---
TOCTitle: '보안 모니터링 및 공격 탐지 계획 가이드 - 4장'
Title: '보안 모니터링 및 공격 탐지 계획 가이드 - 4장'
ms:assetid: '477cd37c-b207-4826-ba8a-02dc45aff6ce'
ms:contentKeyID: 20214091
ms:mtpsurl: 'https://technet.microsoft.com/ko-kr/library/Dd547936(v=TechNet.10)'
---

보안 모니터링 및 공격 탐지 계획 가이드
======================================

### 4장 - 솔루션 설계

업데이트 날짜: 2005년 5월 23일

##### 이 페이지에서

[](#efaa)[소개](#efaa)  
[](#eeaa)[솔루션 요소](#eeaa)  
[](#edaa)[정책 위반 탐지](#edaa)  
[](#ecaa)[외부 공격의 식별](#ecaa)  
[](#ebaa)[법적 분석의 구현](#ebaa)  
[](#eaaa)[요약](#eaaa)  

### 소개

보안 모니터링 및 공격 탐지 시스템에 대한 계획을 작성하는 최종 단계는 솔루션 요구 사항을 처리하는 솔루션을 설계하는 것입니다. 이 솔루션 설계는 다음과 같이 정의된 세 가지 시나리오에 대한 문제점을 고려해야 합니다.

-   정책 위반 탐지

-   외부 공격의 식별

-   법적 분석의 구현

솔루션의 기본 목적은 공격을 식별하고 파악하는 것이므로 이 장에서는 주로 공격이 진행 중임을 나타낼 수 있는 이벤트에 대해 설명합니다. 이러한 공격 프로필은 3장, "문제 및 요구 사항"에 나오는 각 시나리오에 대한 보안 문제와 연결됩니다. 이 솔루션의 정확한 구현은 조직의 네트워크 토폴로지에 따라 달라집니다.

[](#mainsection)[페이지 위쪽](#mainsection)

### 솔루션 요소

솔루션 설계에서는 세 가지 시나리오에 대해 동일한 기본 구성 요소를 사용합니다. 법적 요인을 분석하려면 온라인, 오프라인 및 보관 저장소에 대한 추가 리소스가 필요하지만 해당 솔루션 아키텍처는 다른 두 시나리오에 대한 구현과 크게 다르지 않습니다.

#### 솔루션 개념

보안 모니터링 및 공격 탐지에 대한 솔루션 개념을 구축하려면 다음 영역에 대해 적절한 보안 감사 수준을 검토하고 계획해야 합니다.

-   사용자 만들기 및 그룹에 사용자 추가 등과 같은 계정 관리 작업

-   보호된 파일에 대한 액세스

-   보안 정책 변경

-   트러스트 생성 및 삭제

-   사용자 권한 사용

-   시스템 다시 시작 및 시스템 시간 변경

-   레지스트리 설정 변경

-   알 수 없는 프로그램 실행

보안 모니터링 및 공격 탐지 시스템은 보안 이벤트 로그에서 정보를 수집하고 이 정보를 중앙에 통합합니다. 관리자는 이 데이터를 분석하여 의심스러운 활동이 있는지 확인할 수 있습니다. 또한 나중에 법적 분석에 사용하기 위해 정보를 저장하고 보관할 수 있습니다.

이 솔루션의 주요 구성 요소는 Microsoft Windows Server 2003 서비스 팩 1(SP1)과 Microsoft Windows XP 서비스 팩 2(SP2)의 기능인 사용자 기준 감사를 구성하는 기능입니다. 사용자 기준 감사를 사용하면 의심스러운 사람이나 중요한 계정에 대해 더 높은 감사 수준을 지정하는 등 특정 사용자 계정에 대해 다른 감사 수준을 지정할 수 있습니다.

#### 솔루션 전제 조건

보안 모니터링 및 공격 탐지 시스템 구성의 솔루션 전제 조건은 다음과 같습니다.

-   서버는 Active Directory 디렉터리 서비스 도메인의 일부로 Windows Server 2003 SP1 이상을 실행해야 합니다.

-   클라이언트 컴퓨터는 Active Directory 도메인의 구성원으로 Windows XP 서비스 팩 2 이상을 실행해야 합니다.  

**참고:**  주변 네트워크의 컴퓨터가 도메인이 아닌 작업 그룹의 구성원일 수도 있으므로 이러한 컴퓨터는 Active Directory 그룹 정책 설정으로 구성할 수 없습니다. 그러나 로컬 정책 및 템플릿 파일을 사용하여 이러한 컴퓨터를 구성할 수 있습니다.

이 가이드에서는 보안 이벤트를 중앙에 통합하는 특정 기술을 권장하지 않으며 대신 공격의 징후를 식별하는 데 주안점을 둡니다. 적절한 수집 메커니즘을 결정한 후에 이 장에서 설명하는 이벤트 및 이벤트 시퀀스를 사용하여 공격을 식별하는 쿼리를 만들 수 있습니다.

#### 솔루션 계획

보안 모니터링 및 공격 탐지 시스템을 구현하기 전에 다음을 수행해야 합니다.

-   현재 보안 감사 설정을 검토합니다.

-   관리자 역할 및 사용자 작업을 평가합니다.

-   조직의 정책 및 절차를 검토합니다.

-   취약한 컴퓨터를 식별합니다.

-   고가치 자산을 식별합니다.

-   중요하거나 의심스러운 계정을 식별합니다.

-   허가된 프로그램을 식별합니다.

저장소 요구 사항에 대한 자세한 내용은 이 장 뒷부분의 "법적 분석의 구현" 섹션을 참조하십시오.

##### 현재 보안 감사 설정 검토

조직에서는 현재의 보안 감사 및 보안 이벤트 로그 파일 설정을 검토하여 이 장에서 권장하는 변경 작업의 기준을 제공해야 합니다. 검토할 사항은 다음과 같습니다.

-   현재 적용되는 보안 감사 설정

-   이러한 설정이 적용되는 수준(로컬 컴퓨터, 사이트, 도메인 또는 조직 구성 단위)

-   현재 로그 파일 설정(크기 및 최대 로그 크기에 도달할 때의 동작)

-   적용되는 추가 보안 감사 설정(예: 백업 및 복원 권한의 사용 감사)

부록 B, "그룹 정책 설정 구현"을 참조하여 기록해야 하는 설정을 식별할 수 있습니다. 보안 감사 설정에 대한 자세한 내용은 [Windows Server 2003 Security Guide (영문)](http://www.microsoft.com/downloads/details.aspx?familyid=8a2643c1-0685-4d89-b655-521ea6c7b4db)을 참조하십시오.

##### 관리자 역할 및 사용자 작업 평가

효과적인 보안 모니터링을 구현하기 위한 핵심 요소는 담당 관리자와 관리자가 수행하는 역할 및 책임을 파악하는 것입니다. 예를 들어 대부분의 조직에는 Domain Admins 그룹의 관리자가 있습니다. 도메인 관리자는 도메인에 새 사용자 계정을 만들 수 있습니다. 그러나 조직 정책은 구축 시스템에서만 새 계정을 만들 수 있도록 지정할 수 있습니다. 이러한 상황에서 관리자가 사용자 계정을 만들면 바로 철저한 검토가 필요합니다.

사용자는 관리자보다 네트워크 리소스에 훨씬 더 적게 액세스하므로 사용자 작업은 좀 더 간단하게 평가할 수 있습니다. 예를 들어 사용자는 일반적으로 주변 네트워크의 컴퓨터 파일 시스템에 액세스할 수 있는 권한이 없으므로 이러한 서버에서 사용자의 활동을 모니터링할 필요는 별로 없습니다.

##### 조직의 정책 및 절차 검토

조직 절차의 검토 작업은 관리자 역할 및 책임의 평가와 동일합니다. 예를 들어 그룹에 사용자를 추가할 때는 신중한 검토가 필요합니다. 관련 부서에서는 변경 요청 절차를 설정하고 이러한 요청의 구현 방법을 정의해야 합니다. 승인된 절차를 따르지 않고 그룹에 사용자를 추가하려는 경우에도 역시 철저한 검토가 필요합니다.

##### 취약한 컴퓨터 식별

취약한 컴퓨터는 외부 공격자가 조직의 네트워크에서 처음으로 액세스를 시도할 가능성이 가장 높은 컴퓨터를 말합니다. 대부분의 공격 시나리오에서 이러한 컴퓨터는 주변 네트워크에 속합니다.

모든 취약한 컴퓨터를 포괄적으로 검토하여 다음을 구현해야 합니다.

-   모든 서비스 팩 및 보안 업데이트 적용

-   불필요한 서비스 및 사용자 계정 비활성화

-   가능한 경우 서비스를 로컬 서비스 또는 네트워크 서비스 계정으로 실행하도록 구성

-   사용자 계정 자격 증명(특히 관리 권한이 있는 경우)으로 실행되는 서비스에서 사용자 계정을 요구하는지 확인

-   보안이 강화된 컴퓨터 정책 템플릿 적용

**참고:  **이 검토 프로세스를 취약한 컴퓨터에만 수행해야 하는 것은 아닙니다. 보안 유지를 위해 네트워크의 모든 컴퓨터에서 이러한 작업을 수행하는 것이 좋습니다.

서비스를 안전하게 실행하는 방법에 대한 자세한 내용은 [서비스 및 서비스 계정 보안 계획 가이드](http://www.microsoft.com/korea/technet/security/topics/serversecurity/serviceaccount/default.mspx)를 참조하십시오.

##### 고가치 자산 식별

조직에서 이미 고가치 자산을 식별했을 수도 있지만 이러한 자산 및 각 자산에 대한 보호 체계를 조직 정책의 일부로 문서화할 필요가 있습니다. 예를 들어 기업에서는 ACL(액세스 제어 목록) 및 암호화를 사용하여 NTFS 파일 시스템 파티션에 재무 기록을 안전하게 저장할 수 있습니다. 그러나 조직 정책에 따라 이러한 레코드를 허가되지 않은 사용자나 관리자가 액세스할 수 없도록 보호된 파일로 식별해야 하며 관리자와 사용자는 이러한 제한 사항을 명확히 알고 있어야 합니다.

조직에서는 이러한 보호된 파일에 대한 ACL 변경 내용을 잘 검토해야 합니다. 특히 소유권 변경은 공격자가 적절한 인증 없이 파일에 액세스를 시도했음을 나타낼 수 있으므로 매우 중요합니다. 소유권 변경은 자주 발생하지 않으므로 쉽게 알아낼 수 있습니다.

##### 중요하거나 의심스러운 계정 식별

모든 중요 계정을 검토하여 더 높은 감사 수준이 필요한 계정을 식별해야 합니다. 이러한 계정에는 기본 Administrator 계정, Enterprise, Schema 및 Domain Admins 그룹의 구성원, 서비스가 로그온하는 데 사용하는 계정이 포함됩니다.

개인의 의심스러운 활동이 포착되면 보안 정책에서 해당 사용자에 대해 더 높은 감사 수준을 요구해야 합니다. 사용자 계정의 감사 수준 변경 방법에 대한 자세한 내용은 이 장 뒷부분의 "선택적 감사 사용" 섹션을 참조하십시오.

##### 허가된 프로그램 식별

공격자는 네트워크에 대한 정보를 알아내기 위해 프로그램을 실행해야 하므로 네트워크에서 실행될 수 있는 프로그램을 제한하면 외부 공격자의 위협을 크게 줄일 수 있습니다. 허가된 모든 프로그램에 대한 감사를 수행해야 하며 알 수 없는 프로그램은 모두 의심스러운 프로그램으로 간주해야 합니다. Microsoft Systems Management Server 2003을 사용하여 대기업 환경에 대한 소프트웨어 감사를 수행할 수 있습니다.

**참고:  **개발자가 만드는 실행 파일은 승인된 목록에 없으므로 개발자 워크스테이션 같은 특정 컴퓨터에 대해서는 예외를 설정해야 합니다. 보다 안전한 방법은 개발자들이 기업 네트워크에 연결되어 있지 않은 가상 컴퓨터를 사용하여 프로그램을 개발하고 테스트하도록 하는 것입니다.

#### 솔루션 아키텍처

보안 모니터링 및 공격 탐지 솔루션에는 보안 경고를 제공하는 데 필요한 몇 가지 구성 요소가 있습니다. 이러한 구성 요소에는 다음이 포함됩니다.

-   Active Directory 도메인 컨트롤러

-   이벤트 상관 관계 인프라

-   모니터링 및 분석 워크스테이션

-   온라인 저장소 데이터베이스

-   백업 미디어

-   단기 온사이트 보관 저장소

-   장기 오프사이트 보관 저장소

로컬 보안 설정을 사용하여 보안 감사 수준을 구성할 수도 있기 때문에 Active Directory 도메인 컨트롤러가 반드시 필요한 것은 아닙니다. 그러나 그룹 정책을 사용하여 보안 감사를 구현하려는 경우에는 이 솔루션을 사용할 때 Active Directory가 필요합니다.

#### 솔루션 작동 방식

솔루션 아키텍처 구성 요소는 다음과 같은 방식으로 작동됩니다.

1.  관리자가 그룹 정책 설정을 사용하여 감사 수준에 필요한 변경 내용을 적용합니다. 권장되는 그룹 정책 설정 목록은 부록 B, "그룹 정책 설정 구현"을 참조하십시오.

2.  그룹 정책이 지정된 컴퓨터로 이러한 변경 내용을 전파합니다.

3.  관리자가 주변 네트워크에 있는 컴퓨터처럼 도메인에 속하지 않는 컴퓨터에 대해 로컬 보안 정책의 변경 내용을 적용합니다.

4.  보안 이벤트 로그가 그룹 정책의 설정에 따라 이벤트를 수집합니다.

5.  이벤트 상관 관계 시스템이 정기적으로 보안 이벤트 로그를 검색하고 이 정보를 적절한 데이터베이스에 저장합니다.

6.  보안 관리자가 데이터베이스의 정보를 직접 분석하거나 Lakeside Software의 SysTrack 3과 같은 유틸리티를 사용하여 의심스러운 활동을 식별할 수 있습니다.

법적 분석을 위해 보안 모니터링을 구현하려면 다음과 같은 추가 작업이 필요합니다.

1.  이벤트 상관 관계 시스템이 정기적으로 관련 이벤트를 추출하고 온라인 데이터베이스에 추가합니다.

2.  온라인 데이터베이스의 백업 시스템이 미리 결정된 간격(일반적으로 매일)으로 온라인 데이터베이스에서 레코드를 보관하고 더 이상 사용하지 않는 레코드는 제거합니다.

3.  백업 미디어가 지정된 시간 동안 단기 온사이트 저장소에 남아 있습니다.

4.  정기적으로(일반적으로 매주) 해당 담당자가 이전 백업 미디어를 장기 오프사이트 저장소에 보관합니다.

5.  복원 작업을 담당하는 관리자가 매월 시험 복원을 수행하여 백업이 제대로 작동하는지 확인합니다.

#### 선택적 감사 사용

Windows Server 2003 서비스 팩 1에는 사용자 계정에 대해 선택적 감사 수준을 설정할 수 있는 새로운 기능이 있습니다. 예를 들어 모든 사용자의 로그온 및 로그오프 활동을 감사하고 특정 사용자의 모든 활동을 감사할 수 있습니다. 또는 특정 사용자 계정을 제외한 모든 사용자의 모든 활동을 감사할 수도 있습니다. 선택적 감사 수준을 지정하면 필터링해야 하는 일상적인 이벤트의 수를 줄이거나 의심스러운 개인을 추적할 수 있으며, 보안 또는 메일 그룹이 아닌 사용자 계정만 선택적으로 감사할 수 있습니다.

**auditusr.exe** 명령줄 유틸리티를 사용하여 선택적 감사 수준을 구현할 수 있습니다. Windows Server 2003 SP1과 Windows XP SP2는 둘 다 이 유틸리티가 있습니다. 사용자 기준 감사를 구성하는 방법에 대한 자세한 내용을 보려면 명령 프롬프트에서 **auditusr.exe /?**를 실행하십시오.

**참고:  **사용자 기준 감사를 사용할 경우 기본 제공된 Administrators 그룹의 구성원에 대한 이벤트는 제외할 수 없습니다.

[](#mainsection)[페이지 위쪽](#mainsection)

### 정책 위반 탐지

3장, "문제 및 요구 사항"에서는 네트워크의 가장 큰 위협이 조직 내의 내부 사용자에서 비롯된다는 사실을 보여 줍니다. 엄격한 절차에 따라 까다롭게 사원을 뽑는 조직이라도 가장 신뢰할 수 있는 내부 사용자의 감시를 소홀히 해서는 안 됩니다. 이 장에는 다양한 내부 위협 시나리오와 이러한 상황을 탐지하는 방법을 설명합니다.

의도하지 않은 시스템 또는 네트워크 구성 오류는 일반적으로 관리자 작업으로 인해 발생합니다. 예를 들어 한 관리자가 승인 프로세스를 수행한 후 구성 변경을 구현한 다음 올바른 관리자 자격 증명을 사용하여 다른 사용자가 볼 수 있는 워크스테이션에 로그온했다고 가정할 경우 관리자는 자신의 행동을 숨기려고 하지 않았다는 것을 알 수 있습니다. 관리자가 자신의 활동을 숨기려고 하는지 여부와 같은 요인을 통해 우연히 발생한 구성 오류와 고의적인 공격 행위를 구분할 수 있습니다.

**참고:  **적절한 변경 관리 프로세스를 만들어 구현한 경우 보안 모니터링을 훨씬 더 효과적으로 구현할 수 있습니다. 변경 관리 프로세스가 적절히 구현되지 않으면 확인 기준이 모호하므로 올바른 절차를 사용하여 변경을 수행했는지 파악하기가 훨씬 어렵습니다.

정책을 위반한 공격 행위를 식별하는 능력은 잠재적인 공격을 의미할 수 있는 이벤트 또는 이벤트 시퀀스를 제대로 식별하는가에 따라 좌우됩니다. 이벤트 상관 관계 시스템에서 이 정보를 사용하여 공격 징후를 포착할 수 있습니다.

정책 위반 탐지 작업은 다음과 같은 활동을 감시합니다.

-   파일 사용 권한을 변경하여 리소스에 액세스

-   암호를 다시 설정하여 리소스에 액세스

-   사용자 계정의 작성, 변경 또는 삭제

-   그룹에 사용자 추가

-   허가되지 않은 계정 사용 시도

-   서비스 계정 자격 증명을 사용하여 대화형으로 로그온

-   허가되지 않은 프로그램 실행

-   허가되지 않은 리소스에 액세스    

-   허가된 파일 손상(디스크 오류로 인한 손상 제외)

-   허가되지 않은 운영 체제 도입

-   다른 사용자의 자격 증명 도용

-   감사 회피 시도

-   트러스트 관계 생성 또는 삭제

-   보안 정책의 허가되지 않은 변경

#### 파일 사용 권한을 변경하여 리소스에 액세스

관리자는 파일의 소유권을 변경한 후 해당 파일에 대한 읽기 권한 목록에 자신을 추가하여 읽기 권한이 없는 파일을 볼 수 있습니다. Windows Server 2003 이상에서는 소유권 및 사용 권한을 원래 상태로 다시 변경하여 이러한 동작을 숨길 수 있습니다.

모든 파일에 대해 개체 액세스 감사를 수행하도록 구성하는 것은 효과적이지 못합니다. 이벤트 수가 너무 많아서 불법 활동을 놓칠 수 있기 때문입니다. 대신 중요한 파일과 이러한 파일이 포함되어 있는 폴더에 대한 모든 액세스 또는 변경 내용을 확인하도록 보안 감사 수준을 설정해야 합니다. ACL 항목만으로는 무단 액세스를 적절히 방지하기 어렵습니다.

불법적인 활동을 효과적으로 막으려면 모든 중요 파일에 대해 다음 요인을 파악해야 합니다.

-   액세스하려 시도한 대상 개체는 무엇입니까?

-   어떤 사용자가 액세스를 요청했습니까?

-   사용자에게 해당 개체에 대한 액세스 권한이 있습니까?

-   사용자가 어떠한 유형의 액세스(읽기, 쓰기, 나열 등)를 시도했습니까?

-   이벤트가 성공으로 감사되었습니까 아니면 실패로 감사되었습니까?

-   사용자가 어떤 컴퓨터에서 액세스를 시도했습니까?

이벤트 뷰어는 이러한 정보를 식별하기 위한 충분한 필터 설정을 제공하지 않으므로 EventComb MT 또는 기타 타사 유틸리티를 사용하여 이러한 분석을 수행해야 합니다.

다음 표에서는 파일 사용 권한 변경으로 인해 야기될 수 있는 감사 이벤트를 보여 줍니다. 감사 범주는 개체 액세스입니다.

**표 4.1: 파일 사용 권한 변경 이벤트**

 
<p> </p>
<table style="border:1px solid black;">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >이벤트 ID</th>
<th style="border:1px solid black;" >발생 동작</th>
<th style="border:1px solid black;" >설명</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">560</td>
<td style="border:1px solid black;">기존 개체에 액세스 권한이 부여됨</td>
<td style="border:1px solid black;">이러한 이벤트는 개체의 나열, 읽기, 작성 및 삭제와 같은 요청에 대해 액세스 권한이 부여되었음을 나타냅니다. <strong>기본 로그온 ID</strong>, <strong>클라이언트 사용자 이름</strong> 및 <strong>기본 사용자 이름</strong> 필드를 확인하여 무단으로 파일 사용 권한을 변경하려는 시도를 탐지하십시오. <strong>액세스</strong> 필드를 확인하여 작업 유형을 식별하십시오. 이 이벤트는 액세스가 요청되었거나 허가되었음을 나타낼 뿐이며 액세스가 발생했음을 의미하지는 않습니다. 활동 중인 사용자는 <strong>클라이언트 사용자</strong>(있는 경우)이고 그렇지 않으면 <strong>기본 사용자</strong>입니다.</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">567</td>
<td style="border:1px solid black;">핸들과 연관된 사용 권한이 사용됨</td>
<td style="border:1px solid black;">이 이벤트는 개체에 대한 특정 액세스 유형(나열, 읽기, 작성 등)이 처음 시도될 때 발생합니다. 이벤트 560과의 연관 관계를 파악하려면 두 이벤트의 <strong>핸들 ID</strong> 필드를 비교하십시오.</td>
</tr>
</tbody>
</table>
  
#### 암호를 다시 설정하여 리소스에 액세스
  
암호 다시 설정은 승인된 프레임워크 내에서만 수행해야 합니다. 보안 감사 수준은 보안 이벤트 로그에 암호 다시 설정을 기록하고 올바른 절차를 따르지 않는 암호 다시 설정 작업을 식별하도록 구성되어야 합니다.
  
다음 표에서는 암호 다시 설정으로 인해 야기될 수 있는 감사 이벤트를 보여 줍니다. 감사 범주는 계정 관리입니다.
  
**표 4.2: 암호 다시 설정 이벤트**

 
<p> </p>
<table style="border:1px solid black;">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >이벤트 ID</th>
<th style="border:1px solid black;" >발생 동작</th>
<th style="border:1px solid black;" >설명</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">627</td>
<td style="border:1px solid black;">암호 변경 시도</td>
<td style="border:1px solid black;">이 이벤트는 사용자가 계정에 이전 암호를 제공하도록 되어 있는 암호 변경 요청 시에 발생합니다. <strong>기본 계정 이름</strong>과 <strong>대상 계정 이름</strong>을 비교하여 암호 변경을 계정 소유자가 시도했는지 아니면 다른 사용자가 시도했는지 확인하십시오. <strong>기본 계정 이름</strong>이 <strong>대상 계정 이름</strong>과 다르면 계정 소유자 이외의 사용자가 암호를 변경하려고 한 것입니다. Microsoft Windows Me 또는 Windows NT가 실행되는 컴퓨터에서는 변경을 요청한 계정을 익명 계정으로 간주하는 것이 일반적입니다. 인증된 사용자가 아닐 수도 있기 때문입니다. 그러나 요청자는 이전 암호를 제공해야 하므로 심각한 보안 위험이 되지는 않습니다.</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">628</td>
<td style="border:1px solid black;">사용자 계정 암호 설정 또는 다시 설정</td>
<td style="border:1px solid black;">사용자나 프로세스가 암호 변경 프로세스가 아닌 Active Directory 사용자 및 컴퓨터 같은 관리 인터페이스를 통해 계정 암호를 다시 설정하는 경우에 기록됩니다. 이 프로세스는 지원 부서 또는 사용자 셀프 서비스 암호 다시 설정과 같이 허가된 프로세스 또는 사용자만 수행해야 합니다.</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">698</td>
<td style="border:1px solid black;">디렉토리 서비스 복원 모드 암호 변경</td>
<td style="border:1px solid black;">누군가가 도메인 컨트롤러에서 디렉토리 서비스 복원 모드 암호를 변경하려고 시도하는 경우에 기록됩니다. <strong>워크스테이션 IP</strong> 및 <strong>계정 이름</strong>을 확인하고 즉시 조사하십시오.</td>
</tr>
</tbody>
</table>
  
#### 사용자 계정의 작성, 변경 또는 삭제
  
새 사용자 계정을 만들 때는 항상 설정된 프로세스를 따라야 합니다. 자동 구축 시스템이 갖추어져 있는 대기업에서는 이러한 프로세스에 새로 채용된 직원의 계정 작성을 승인하기 위해 관리자가 웹 사이트에 로그온해야 하는 다단계 비즈니스 논리 프로세스가 포함될 수 있습니다. 중소기업인 경우에도 Active Directory에서 사용자 계정을 만들려면 반드시 공식적인 요청이 있어야 합니다. 따라서 사용자 계정 작성을 기록하는 모든 이벤트는 계정 작성 요청과 대응되어야 합니다. 신뢰할 수 없는 관리자는 존재하지 않는 직원에 대해 가짜 사용자 계정을 만든 후 해당 계정을 사용하여 무단 액세스 및 악의적인 작업을 쉽게 수행할 수 있습니다.
  
또한 새 사용자 계정을 작성한 후 해당 사용자가 빠른 시간 내에 로그온하여 암호를 변경하지 않으면 안 되도록 설정해야 합니다. 새 사용자가 미리 결정한 시간 내에 새 계정에 로그온하지 않으면 구축 시스템은 해당 계정을 비활성화하고 보안 담당자는 지연된 원인을 조사해야 합니다.
  
보안 모니터링 및 공격 탐지 기능을 사용하여 사용자 계정 문제를 식별하려면 다음 작업을 수행하는 쿼리를 구성해야 합니다.
  
-   불규칙하거나 비정상적인 네트워크 계정 활동 찾기
  
-   권한을 남용하여 계정을 만들거나 수정하는 관리자 식별
  
-   조직의 보안 정책을 위반하는 계정 활동 패턴 탐지
  
다음 표에서는 사용자 계정 변경을 식별하는 이벤트를 보여 줍니다. 모든 이벤트는 계정 관리 감사 범주에 속합니다.
  
**표 4.3: 사용자 계정 변경 이벤트**

 
<p> </p>
<table style="border:1px solid black;">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >이벤트 ID</th>
<th style="border:1px solid black;" >발생 동작</th>
<th style="border:1px solid black;" >설명</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">624</td>
<td style="border:1px solid black;">사용자 계정 만들기</td>
<td style="border:1px solid black;">허가된 사용자 및 프로세스만 네트워크 계정을 만들어야 합니다. <strong>기본 사용자 이름</strong> 필드를 검토하여 허가된 사용자나 프로세스가 계정을 만들었는지 여부를 확인하십시오. 이 이벤트는 관리자가 조직의 정책 지침을 벗어나 계정을 만들었는지 여부도 탐지합니다.</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">630</td>
<td style="border:1px solid black;">사용자 계정 삭제</td>
<td style="border:1px solid black;">허가된 사용자 및 프로세스만 네트워크 계정을 삭제해야 합니다. 이러한 이벤트를 검색하고 <strong>기본 계정 이름</strong> 필드를 검토하여 허가되지 않은 사용자가 계정을 삭제했는지 확인하십시오.</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">642</td>
<td style="border:1px solid black;">사용자 계정 변경</td>
<td style="border:1px solid black;">이 이벤트는 사용자 계정의 보안 관련 속성 변경 내용 중 이벤트 627 - 630에 해당되지 않는 내용을 기록합니다.</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">685</td>
<td style="border:1px solid black;">계정 이름 변경</td>
<td style="border:1px solid black;"><strong>기본 계정 이름</strong>이 허가된 사용자나 프로세스에 해당하는지 확인하십시오.</td>
</tr>
</tbody>
</table>
  
#### 그룹에 사용자 추가
  
올바른 보안 정책은 사용자에게 작업 수행에 필요한 최소한의 권한만 부여하는 최소 권한의 원칙을 따릅니다. 대부분의 사용자 계정은 조직 고유의 보안 그룹과 함께 Domain Users 그룹에만 속한 구성원이어야 합니다.
  
특히 Domain, Schema 또는 Enterprise Admins와 같은 높은 권한을 갖는 사용자를 보안 그룹에 추가할 때는 반드시 정책 지침을 따라야 하며 확정 및 승인된 계정이나 프로세스를 사용해야 합니다. 그 밖의 변경 내용은 의심스러운 것으로 취급하고 자세히 조사해야 합니다.
  
**참고**:  메일 그룹은 보안 주체가 아니므로 메일 그룹 구성원 자격이 있어도 네트워크 리소스에 액세스할 수 없습니다. 그러나 특정 메일 그룹의 구성원 자격을 부여할 경우 다른 유형의 보안 문제를 유발할 수 있습니다. 예를 들어 실수로 사용자 계정을 부회장 또는 이사 메일 그룹에 포함시킬 경우 해당 사용자가 자신의 직책에 맞지 않는 전자 메일을 받을 수 있습니다.
  
다음 표에서는 그룹 변경 내용을 식별하는 이벤트를 보여 줍니다. 모든 이벤트는 계정 관리 감사 범주에 속합니다.
  
**표 4.4: 그룹 구성원 변경 이벤트**

 
<p> </p>
<table style="border:1px solid black;">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >이벤트 ID</th>
<th style="border:1px solid black;" >발생 동작</th>
<th style="border:1px solid black;" >설명</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">631 - 634</td>
<td style="border:1px solid black;">보안 사용 글로벌 그룹 변경</td>
<td style="border:1px solid black;">Domain Admins 그룹과 같이 글로벌 또는 광범위한 액세스 권한을 갖는 그룹에 대해 이 이벤트를 검토하여 조직 정책 제한 사항에 위배되는 변경이 수행되지 않도록 하십시오. 그룹 이름은 <strong>대상 계정 이름</strong> 필드에 있습니다.</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">635 - 638</td>
<td style="border:1px solid black;">보안 사용 로컬 그룹 변경</td>
<td style="border:1px solid black;">Administrators, Server Operators 및 Backup Operators와 같은 그룹에 대해 이 이벤트를 검토하여 정책 제한 사항에 위배되는 변경이 수행되지 않도록 하십시오. 그룹 이름은 <strong>대상 계정 이름</strong> 필드에 있습니다.</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">639
641
668</td>
<td style="border:1px solid black;">보안 사용 그룹 변경</td>
<td style="border:1px solid black;">이러한 이벤트는 삭제, 작성 또는 구성원 변경 이외의 변경 작업이 그룹에 수행되었음을 나타냅니다. 권한 수준이 높은 그룹에 대해 이러한 이벤트를 검토하여 정책 제한 사항에 위배되는 변경이 수행되지 않도록 하십시오. 그룹 이름은 <strong>대상 계정 이름</strong> 필드에 있습니다.</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">659 - 662</td>
<td style="border:1px solid black;">보안 사용 유니버설 그룹 변경</td>
<td style="border:1px solid black;">Enterprise Admins 또는 Schema Admins와 같이 권한 수준이 높은 그룹에 대해 이러한 이벤트를 검토하여 정책 제한 사항에 위배되는 변경이 수행되지 않도록 하십시오. 그룹 이름은 <strong>대상 계정 이름</strong> 필드에 있습니다.</td>
</tr>
</tbody>
</table>
  
#### 허가되지 않은 계정 사용 시도
  
포리스트에 있는 첫 번째 Active Directory 도메인 컨트롤러를 승격하면 Domain Admins 및 Enterprise Admins 그룹의 구성원인 관리자 계정이 만들어집니다. 이 계정은 계정 잠금 설정이 적용되지 않는 유일한 계정이므로 특별한 보호가 필요합니다. 따라서 계정 잠금 정책이 설정된 경우에도 이 계정은 사전 공격을 받기 쉽습니다.
  
사용자가 이 관리자 계정의 이름을 바꾼 경우에도 보안 모니터링은 해당 계정으로 로그온하려는 시도를 식별해야 합니다. 관리 계정의 보안 승격에 대한 자세한 내용은 [관리자 계정 보안 계획 가이드 (영문)](http://go.microsoft.com/fwlink/?linkid=41307)를 참조하십시오.
  
비활성화되었거나 만료된 계정으로 로그온하려고 시도하는 것은 이전 직원, 임시 직원 또는 계약 직원이 인증 없이 네트워크에 액세스하려고 하는 경우일 수 있습니다. 이러한 이벤트가 발생하면 즉각적인 조사가 필요합니다.
  
다음 표에서는 허가되지 않은 계정 사용을 식별하는 이벤트를 보여 줍니다. 이벤트는 계정 로그온 및 로그온 감사 범주에 속합니다.
  
**표 4.5: 허가되지 않은 로그온 이벤트**

 
<p> </p>
<table style="border:1px solid black;">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >이벤트 ID</th>
<th style="border:1px solid black;" >발생 동작</th>
<th style="border:1px solid black;" >설명</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">528/540</td>
<td style="border:1px solid black;">로그온 성공</td>
<td style="border:1px solid black;"><strong>대상 계정 이름</strong>이 기본 관리자 계정과 동일한 의심스러운 상황입니다. 그러나 이벤트 528은 일반적인 작업에서 흔히 발생하는 이벤트입니다.</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">529</td>
<td style="border:1px solid black;">로그온 실패 — 알 수 없는 사용자 이름 또는 암호</td>
<td style="border:1px solid black;"><strong>대상 계정 이름</strong>이 Administrator 또는 이름이 바뀐 기본 관리자 계정과 동일한 로그온 시도를 확인하십시오. 여러 번 실패한 로그온 시도 중 계정 잠금 임계값보다 적게 시도한 경우를 확인하십시오.</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">531</td>
<td style="border:1px solid black;">로그온 실패 — 비활성화된 계정</td>
<td style="border:1px solid black;">이 이벤트는 항상 조사하십시오. <strong>대상 계정 이름</strong> 값과 <strong>워크스테이션 이름</strong>을 확인하십시오. 이 이벤트는 권한 없는 이전 내부 사용자의 로그온 시도를 나타낼 수 있습니다.</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">532</td>
<td style="border:1px solid black;">로그온 실패 — 만료된 계정</td>
<td style="border:1px solid black;">이 이벤트는 항상 조사하십시오. <strong>대상 계정 이름</strong> 값과 <strong>워크스테이션 이름</strong>을 확인하십시오. 이 이벤트는 권한 없는 계약 직원 또는 임시 내부 사용자의 로그온 시도를 나타낼 수 있습니다.</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">576</td>
<td style="border:1px solid black;">새 로그온에 특수 권한이 지정됨</td>
<td style="border:1px solid black;">이 이벤트는 새 로그온 세션이 관리자 액세스 권한을 제공하거나 감사 내역을 무단 변경할 수 있는 권한을 얻을 때마다 나타납니다. 이벤트 528과 이벤트 540의 <strong>로그온 ID</strong> 필드를 비교하여 두 이벤트의 연관 관계를 파악하십시오. 이벤트 576은 로그온 시 계정이 관리자와 동일한 권한을 얻었는지 여부를 빠르게 확인할 수 있는 방법입니다. 이 방법은 그룹 구성원을 파악하는 것보다 더 쉽습니다.</td>
</tr>
</tbody>
</table>
  
#### 서비스 계정 자격 증명을 사용하여 대화형으로 로그온
  
서비스가 시작될 때 해당 서비스는 로그온 자격 증명을 제공해야 합니다. 일부 경우에 서비스 계정은 원격 컴퓨터의 서비스를 연결 및 실행하도록 도메인 계정에 요청할 수 있습니다. 일부 서비스 계정은 관리자 자격 증명으로 실행되거나 데스크톱과 상호 작용해야 합니다.
  
Windows Server 2003 이상에서는 **–LocalService** 스위치를 사용하여 일부 서비스 계정(예: Alerter 서비스)을 시작할 수 있습니다. 네트워크에 연결해야 하는 서비스는 네트워크 서비스 계정인 NT AUTHORITY\\NetworkService를 사용할 수 있습니다. 사용자 계정을 필요로 하는 모든 서비스를 확인하여 이러한 계정이 강력한 암호를 사용하는지 확인해야 합니다. 보안 모니터링은 이러한 계정에 대한 로그온 이벤트가 관련 서비스가 시작될 때만 발생하는지 확인해야 합니다. 서비스 계정의 보안 승격에 대한 자세한 내용은 [서비스 및 서비스 계정 보안 계획 가이드](http://www.microsoft.com/korea/technet/security/topics/serversecurity/serviceaccount/default.mspx)를 참조하십시오.
  
서비스 계정이 서비스로서가 아니라 대화형으로 로그온할 경우 중대한 보안 문제가 야기됩니다. 이 이벤트는 침입자가 서비스 계정에 대한 암호를 알아내 해당 계정으로 로그온할 때만 발생할 수 있습니다. 해당 서비스 계정에 관리자 권한이 있는 경우 침입자는 일반적인 네트워크 서비스를 중단시킬 수 있습니다.
  
서비스 계정이 액세스할 수 있는 모든 리소스를 식별해야 합니다. 예를 들어 서비스 계정이 때때로 로그 파일 디렉터리에 대한 쓰기 권한을 요구할 수 있지만 이것이 일반적인 경우는 아닙니다. 중요한 데이터에 액세스하기 위해서는 서비스 계정의 사용 권한이 명확해야 합니다. 데스크톱과 상호 작용할 수 있는 서비스 계정은 공격자에게 침입 기회를 제공하므로 철저히 조사해야 합니다.
  
다음 표에서는 서비스 계정 자격 증명의 무단 사용을 식별하는 이벤트를 보여 줍니다. 이벤트는 계정 로그온 및 로그온 감사 범주에 속합니다.
  
**표 4.6: 서비스 계정 자격 증명을 사용한 로그온 이벤트**

 
<p> </p>
<table style="border:1px solid black;">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >이벤트 ID</th>
<th style="border:1px solid black;" >발생 동작</th>
<th style="border:1px solid black;" >설명</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">528</td>
<td style="border:1px solid black;">로그온 성공 – 콘솔 공격 또는 터미널 서비스</td>
<td style="border:1px solid black;">이벤트 로그에 서비스 계정 또는 로컬 시스템에 대해 <strong>로그온 유형 2</strong>로 이벤트 528이 기록된 경우, 공격이 진행 중이며 공격자가 서비스 계정의 암호를 얻어 해당 콘솔에 로그온한 것입니다. 이벤트 로그에 <strong>로그온 유형 10</strong>이 기록된 경우 공격자가 터미널 서비스를 사용하여 로그온한 것입니다. 두 경우 모두 즉각적으로 조사를 수행해야 합니다.</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">534</td>
<td style="border:1px solid black;">로그온 실패 — 허용되지 않는 로그온 유형</td>
<td style="border:1px solid black;"><strong>대상 계정 이름</strong>, <strong>워크스테이션 이름</strong> 및 <strong>로그온 유형</strong>을 확인하십시오. 이 이벤트는 그룹 정책에서 계정이 대화형 로그온을 수행하지 못하도록 설정되어 있는 경우 서비스 계정 자격 증명을 사용하여 대화형으로 로그온하려는 시도가 실패했음을 나타냅니다.</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">600</td>
<td style="border:1px solid black;">프로세스에 기본 토큰이 할당됨</td>
<td style="border:1px solid black;">이 이벤트는 서비스가 명명된 계정을 사용하여 Windows XP 이상이 실행되는 컴퓨터에 로그온할 때 발생합니다. 이 이벤트와 이벤트 672, 673, 528, 592의 연관 관계를 파악하십시오.</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">601</td>
<td style="border:1px solid black;">사용자가 서비스를 설치하려고 시도함</td>
<td style="border:1px solid black;">서비스의 설치는 일상적으로 수행되는 작업이 아니므로 이 이벤트는 아주 드물게 발생합니다. 이 이벤트의 모든 성공 및 실패 결과를 조사해야 합니다.</td>
</tr>
</tbody>
</table>
  
#### 허가되지 않은 프로그램 실행
  
관리자는 신뢰할 수 있는 직원이므로 프로그램을 설치 및 실행할 수 있습니다. 조직에서는 승인 및 허가된 프로그램 목록과 새 프로그램에 대한 승인 프로세스를 만들어야 합니다. 관리자는 새 프로그램을 분리된 네트워크 세그먼트에서 테스트하고 승인된 목록에 포함되지 않은 프로그램은 실행하지 않도록 해야 합니다.
  
프로세스 추적에 대한 보안 감사를 통해 허가되지 않은 프로그램을 식별할 수 있습니다. 그러나 프로세스 추적은 여러 개의 보안 로그 항목을 생성하므로 이벤트 수가 너무 많아져서 감지 메커니즘에 문제가 생기지 않도록 주의해야 합니다.
  
다음 표에서는 허가되지 않은 프로그램의 사용을 식별하는 이벤트를 보여 줍니다. 이벤트는 프로세스 추적 감사 범주에 속합니다.
  
**표 4.7: 허가되지 않은 프로그램 실행 이벤트**

 
<p> </p>
<table style="border:1px solid black;">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >이벤트 ID</th>
<th style="border:1px solid black;" >발생 동작</th>
<th style="border:1px solid black;" >설명</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">592</td>
<td style="border:1px solid black;">새 프로세스 만들기</td>
<td style="border:1px solid black;">새 프로세스에 대한 <strong>이미지 파일 이름</strong>과 <strong>사용자 이름</strong>을 확인하십시오. 모든 프로세스는 허가된 프로그램 목록에 속해 있어야 합니다.<strong> </strong></td>
</tr>
<tr class="even">
<td style="border:1px solid black;">602</td>
<td style="border:1px solid black;">예약된 작업 만들기</td>
<td style="border:1px solid black;"><strong>대상 이름</strong>을 확인하여 예약된 프로세스를 실행할 권한이 있는지 확인하고 <strong>작업 시간</strong>을 확인하여 알려진 작업 일정과의 이벤트 상관 관계를 파악하십시오.</td>
</tr>
</tbody>
</table>
  
#### 허가되지 않은 리소스에 액세스
  
이 경우에는 이벤트 ID 560의 감사 실패를 식별해야 합니다. 다음 표에서는 허가되지 않은 리소스에 액세스할 때 발생하는 이벤트를 보여 줍니다. 감사 범주는 개체 액세스입니다.
  
**표 4.8: 허가되지 않은 리소스에 대한 액세스 시도 이벤트**

 
<p> </p>
<table style="border:1px solid black;">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >이벤트 ID</th>
<th style="border:1px solid black;" >발생 동작</th>
<th style="border:1px solid black;" >설명</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">560</td>
<td style="border:1px solid black;">기존 개체에 대한 액세스가 거부됨</td>
<td style="border:1px solid black;">감사 실패를 모니터링하십시오. 액세스된 리소스에 대한 <strong>개체 이름</strong> 필드를 확인하십시오. <strong>기본 사용자 이름</strong> 및 <strong>기본 도메인</strong> 필드 또는 <strong>클라이언트 사용자 이름</strong> 및 <strong>클라이언트 도메인</strong> 필드와의 연관 관계를 파악하십시오.</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">568</td>
<td style="border:1px solid black;">감사된 파일에 대한 하드 링크를 만들려고 시도함</td>
<td style="border:1px solid black;">이 이벤트는 사용자나 프로그램이 파일 또는 개체에 대한 하드 링크를 만들려고 시도할 때 발생합니다. 사용자가 하드 링크를 만들면 감사 내역을 만들지 않고도 자신의 권한 내에서 파일을 조작할 수 있습니다.</td>
</tr>
</tbody>
</table>
  
#### 허가된 파일 손상
  
사용자가 파생 결과에 개의치 않고 액세스 가능한 파일을 고의로 손상시키는 경우입니다. 이러한 유형의 동작은 조직에서 사용자를 해고했지만 관리자가 해당 사용자의 계정을 아직 비활성화하지 않았을 때 가장 일반적으로 발생합니다.
  
이러한 고의적인 손상 가능성을 줄이려면 해당 사용자의 계정을 즉시 비활성화하고 사용자를 강제로 로그오프시키도록 체계적으로 문서화한 효과적인 구축 해제 전략이 필요합니다.
  
#### 허가되지 않은 운영 체제 도입
  
관리자와 사용자는 다음 메커니즘을 통해 네트워크에 허가되지 않은 운영 체제를 도입할 수 있습니다.
  
-   네트워크에 연결되어 있는 가정용 컴퓨터
  
-   CD로 부팅 가능한 운영 체제
  
-   Windows XP 또는 기타 Windows 운영 체제 다시 설치
  
-   Microsoft 가상 PC 이미지
  
허가되지 않은 운영 체제는 다음과 같은 심각한 문제를 유발할 수 있습니다.
  
-   보안 업데이트의 미적용으로 인한 보안 취약점 증가
  
-   허가되지 않은 운영 체제가 네트워크의 다른 컴퓨터와 동일한 주소를 갖는 IP 주소 중복
  
-   바이러스 및 기타 악의적인 소프트웨어에 대한 취약점 증가
  
-   파일 손상 가능성 증가
  
-   지원 부서로의 지원 요청 증가
  
-   생산성 감소
  
조직 정책에서는 원격 위치에서 작업하는 사용자가 기업 네트워크에 연결하기 위해 원격 액세스 서비스를 사용하도록 할지 아니면 가상 사설망을 사용하도록 할지 여부를 지정할 수 있습니다. 원격 컴퓨터가 네트워크에 연결되기 전에 조직의 보안 정책을 따르도록 하는 방법은 [Implementing Quarantine Services with Microsoft Virtual Private Network Planning Guide (영문)](http://go.microsoft.com/fwlink/?linkid=41307)를 참조하십시오.
  
**참고:  **일부 소스 개방형 소프트웨어는 시작 CD를 사용하여 배포할 수 있습니다. 이러한 운영 체제 중 하나를 시작하기 위해 사용자가 CD를 넣고 컴퓨터를 다시 시작할 수 있습니다. 소스 개방형 소프트웨어는 Windows와는 별개로 실행되므로 이벤트 로그 모니터링을 통해 이러한 동작을 탐지하지 못할 수도 있습니다. 그러나 동일한 유형의 환경에서 사용자 "루트"로 로그온을 시도하면 허가되지 않은 운영 체제가 사용되는지 알 수 있습니다. 클라이언트 컴퓨터에서 CD 드라이브를 제거하면 이러한 문제를 해결할 수 있지만 이 방법이 항상 가능한 것은 아닙니다.
  
사용자가 Windows XP 설치 CD를 구한 후 컴퓨터를 다시 시작하여 Windows XP를 다시 설치할 수도 있습니다. 이 경우 다른 컴퓨터에 대한 이벤트 로그 모니터링을 수행하면 식별되지 않은 작업 그룹 이름 또는 기본 이름 "Workgroup"을 갖는 사용자 "Administrator"가 수행한 로그온 시도를 탐지할 수 있습니다.
  
가상 PC 이미지는 호스트 컴퓨터의 컴퓨터 환경에 대한 완전한 에뮬레이션을 제공합니다. 이 에뮬레이션은 자체의 컴퓨터 이름, 계정, 작업 그룹 또는 도메인 구성원 및 프로그램을 사용하여 자체의 운영 체제를 실행합니다. 가상 PC 이미지는 호스트 컴퓨터에 영향을 주지 않으면서 시작, 실행 및 종료될 수 있으며, IP 주소를 요청하여 기업 네트워크 리소스에 액세스할 수도 있습니다. 가상 PC 이미지는 빈 암호 또는 쉽게 추측할 수 있는 암호의 사용으로 인해 보안 위험을 가져올 수 있습니다. 보안이 유지되지 않는 가상 PC 이미지를 실행하는 사용자는 네트워크 공유에 드라이브를 매핑하거나 Microsoft IIS(인터넷 정보 서비스)와 같은 구성 요소를 설치할 수 있습니다. 이러한 구성 요소는 서비스 팩이나 보안 업데이트를 통해 나중에 보완되어야 하는 근본적인 보안 취약점이 있습니다.
  
다음을 탐지하도록 보안 모니터링을 구성해야 합니다.
  
-   인식할 수 없는 사용자, 컴퓨터, 작업 그룹 또는 도메인 이름
  
-   중복되거나 범위를 벗어난 IP 주소
  
-   기본 Administrator 계정을 사용하여 로그온하려는 시도
  
다음 표에서는 허가되지 않은 운영 체제의 사용을 식별하는 이벤트를 보여 줍니다. 이 이벤트는 프로세스 추적 감사 범주에 속합니다.
  
**표 4.9: 허가되지 않은 플랫폼 실행 이벤트**

 
<p> </p>
<table style="border:1px solid black;">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >이벤트 ID</th>
<th style="border:1px solid black;" >발생 동작</th>
<th style="border:1px solid black;" >설명</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">529</td>
<td style="border:1px solid black;">로그온 실패 — 알 수 없는 사용자 이름 또는 암호</td>
<td style="border:1px solid black;"><strong>대상 계정 이름</strong>이 Administrator이고 <strong>도메인 이름</strong>을 알 수 없거나 <strong>대상 계정 이름</strong>이 루트인 로그온 시도를 확인하십시오.</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">592</td>
<td style="border:1px solid black;">새 프로세스 만들기</td>
<td style="border:1px solid black;">새 프로세스에 대한 <strong>이미지 파일 이름</strong> 및 <strong>사용자 이름</strong>을 확인하십시오. 모든 프로세스는 허가된 프로그램이어야 합니다.<strong> </strong></td>
</tr>
</tbody>
</table>
  
**참고:  **루트 키트를 보다 확실하게 탐지하려면 Sysinternals의 RootkitRevealer이나 F-Secure의 Blacklight와 같은 타사 제품을 평가하십시오. RootkitRevealer에 대한 자세한 내용은 [RootKitRevealer (영문)](http://www.sysinternals.com/ntw2k/freeware/rootkitreveal.shtml)을 참조하고 Blacklight에 대한 자세한 내용은 [Revolutionary F-Secure BlackLight Technology (영문)](http://www.f-secure.com/news/items/news_2005030701.shtml) 보도 자료를 참조하십시오.
  
#### 다른 사용자의 자격 증명 도용
  
특정 암호 길이와 정기적인 암호 변경을 요구하는 등 바람직한 암호 정책을 사용하더라도 사용자가 자신의 암호를 적어 두는 경우 의도하지 않은 결과를 초래할 수 있습니다. 이러한 상황은 다양한 환경에 대한 각각의 여러 ID 저장소가 있어서 사용자가 여러 번 로그온해야 하는 경우 특히 자주 발생합니다.
  
**참고:** 다양한 환경에서의 암호 관리에 대한 자세한 내용은 [Identity and Access Management Series (영문)](http://www.microsoft.com/technet/security/topics/identity/idmanage/default.mspx)을 참조하십시오.
  
암호를 적어서 눈에 잘 띄는 곳에 둘 경우 허가되지 않은 사용자가 사무실에 들어와 사용자의 로그온 자격 증명을 쉽게 찾을 수 있으므로 조직에서는 암호를 적어 두는 사용자에 대해 특별히 주의시킬 필요가 있습니다. 보안 모니터링은 사용자가 일반적으로 사용하지 않는 컴퓨터에 로그온하는 경우를 탐지해야 합니다. 이러한 유형의 공격을 탐지하려면 워크스테이션 이름 및 해당 워크스테이션에 대한 사용자 액세스나 권한 부여와 로그온 성공 사례의 연관 관계를 파악해야 합니다.
  
**참고:** Active Directory를 사용하여 사용자가 로그온할 수 있는 워크스테이션을 제어할 수 있습니다. 이 기능을 사용하려면 WINS(Windows Internet Naming Service)와 같은 NetBIOS(네트워크 기본 입/출력 시스템) 명명 기능이 지원되어야 합니다.
  
이러한 상황에 대한 이벤트는 표 4.5 "허가되지 않은 로그온 이벤트"에 나열된 이벤트와 동일합니다.
  
#### 감사 회피 시도
  
공격자는 다양한 방법을 이용하여 검색을 피할 수 있습니다. 예를 들어 공격자는 이벤트 로그가 의심스러운 활동을 기록하지 못하도록 컴퓨터나 도메인의 보안 정책을 변경하거나 감사 데이터가 손실되도록 고의로 보안 로그를 지울 수 있습니다. 이러한 이벤트는 대부분 일반적인 네트워크 작업의 일부로 주기적으로 발생하기 때문에 흔적을 감추려는 시도를 탐지하는 것은 어려운 일일 수 있습니다.
  
다음 표에서는 보안 위배의 증거를 감추려고 하는 공격자로 인해 발생할 수 있는 이벤트를 식별하는 이벤트를 보여 줍니다. 이벤트는 여러 감사 범주에 속합니다.
  
**표 4.10: 감사 회피 이벤트**

 
<p> </p>
<table style="border:1px solid black;">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >이벤트 ID</th>
<th style="border:1px solid black;" >발생 동작</th>
<th style="border:1px solid black;" >설명</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">512</td>
<td style="border:1px solid black;">Windows가 시작됨</td>
<td style="border:1px solid black;">일반적으로 이벤트 513 이후에 나타납니다. 예상치 못한 시스템 다시 시작에 대해 조사하십시오.</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">513</td>
<td style="border:1px solid black;">Windows가 종료됨</td>
<td style="border:1px solid black;">일반적으로 이벤트 512 이후에 나타납니다. 중요한 컴퓨터에서는 허가된 직원이 정책에 따라 컴퓨터를 다시 시작해야 합니다. 이 이벤트가 서버에서 발생하면 즉시 조사를 수행해야 합니다.</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">516</td>
<td style="border:1px solid black;">감사 실패</td>
<td style="border:1px solid black;">이 이벤트는 보안 이벤트가 너무 많이 발생하여 이벤트 로그 버퍼가 넘칠 때 발생할 수 있습니다. 감사할 이벤트 수를 제한하십시오. 이 이벤트는 기존 로그를 덮어쓰지 않도록 보안 로그를 구성할 경우에도 발생할 수 있습니다. 높은 감사 로그 수준을 유지해야 하는 구역에 있는 컴퓨터는 철저히 모니터링해야 합니다. 보안 설정으로 인해 보안 로그가 꽉 찰 때 일부 컴퓨터가 종료될 수 있습니다. 보안이 필요한 모든 컴퓨터에서 이벤트 516을 모니터링하십시오.</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">517</td>
<td style="border:1px solid black;">보안 이벤트 로그 지우기</td>
<td style="border:1px solid black;">관리자는 인증 없이 보안 이벤트 로그를 지워서는 안 됩니다. <strong>클라이언트 사용자 이름</strong> 및 <strong>클라이언트 도메인</strong>을 확인한 후 허가된 직원과의 연관 관계를 파악하십시오.</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">520</td>
<td style="border:1px solid black;">시스템 시간 변경</td>
<td style="border:1px solid black;">이 동작이 수행되면 법적 조사가 잘못 진행되거나 공격자가 거짓 알리바이를 확보할 수 있습니다. 프로세스 이름은 <strong>%windir %\system32\svchost.exe</strong>입니다. <strong>클라이언트 사용자 이름</strong> 및 <strong>클라이언트 도메인</strong>을 확인한 후 허가된 직원과의 연관 관계를 파악하십시오.</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">521</td>
<td style="border:1px solid black;">이벤트를 기록할 수 없음</td>
<td style="border:1px solid black;">Windows에서 보안 이벤트 로그에 이벤트를 쓸 수 없습니다. 중요한 컴퓨터에서 이 이벤트가 발생할 경우 즉시 조사를 수행해야 합니다.</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">608</td>
<td style="border:1px solid black;">사용자 계정 권한이 할당됨</td>
<td style="border:1px solid black;">이 동작으로 인해 사용자 계정에 새 권한이 부여됩니다. 이벤트 로그는 사용자 계정 이름이 아닌 사용자 계정 SID(보안 식별자)와 함께 이 동작을 기록합니다.</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">609</td>
<td style="border:1px solid black;">사용자 계정 권한이 제거됨</td>
<td style="border:1px solid black;">이 동작으로 인해 사용자 계정 권한이 제거됩니다. 이벤트 로그는 사용자 계정 이름이 아닌 사용자 계정 SID와 함께 이 동작을 기록합니다.</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">612</td>
<td style="border:1px solid black;">감사 정책 변경</td>
<td style="border:1px solid black;">이 이벤트가 발생했다고 해서 항상 문제가 있는 것은 아닙니다. 그러나 공격자가 컴퓨터 시스템 공격의 일부로 감사 정책을 변경할 수도 있으므로 중요한 컴퓨터 및 도메인 컨트롤러에서는 이 이벤트를 모니터링해야 합니다.</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">621</td>
<td style="border:1px solid black;">계정에 시스템 액세스 권한이 부여됨</td>
<td style="border:1px solid black;">사용자에게 시스템 액세스 권한이 부여되었습니다. <strong>사용자 이름</strong> 및 <strong>수정된 계정</strong>을 확인하십시오. 특히 액세스 권한이 대화형인 경우 반드시 확인해야 합니다.</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">622</td>
<td style="border:1px solid black;">계정에서 시스템 액세스 권한이 제거됨</td>
<td style="border:1px solid black;">이 이벤트는 공격자가 이벤트 621의 증거를 없앴거나 다른 계정에 대한 서비스를 거부하려고 하는 경우를 나타낼 수 있습니다.</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">643</td>
<td style="border:1px solid black;">도메인 보안 정책 변경</td>
<td style="border:1px solid black;">이 이벤트는 암호 정책이나 다른 도메인 보안 정책 설정을 수정하려고 시도했음을 나타냅니다. 주체의 사용자 이름을 확인하고 인증과의 연관 관계를 파악하십시오.</td>
</tr>
</tbody>
</table>
  
#### 트러스트 관계 생성 또는 삭제
  
트러스트 관계가 있으면 한 도메인의 사용자 계정으로 다른 도메인의 네트워크 리소스에 액세스할 수 있습니다. 자동 양방향 전이적 트러스트 관계는 동일한 Active Directory 포리스트 내의 모든 도메인에 걸쳐 있습니다. 다른 상황에서는 다음과 같은 트러스트 관계를 수동으로 만들어야 할 수 있습니다.
  
-   Windows NT 4.0 도메인이 포함된 트러스트
  
-   도메인 간 바로 가기 트러스트
  
-   Windows 2000 Server에서 여러 다른 포리스트에 있는 도메인 간 트러스트
  
-   Windows Server 2003에서 포리스트 간 트러스트
  
트러스트 관계를 만드는 것은 명확하게 정의, 승인 및 설정된 프로세스를 통해 엔터프라이즈 관리자만 수행해야 하는 정기적인 작업이 아닙니다. 마찬가지로 엔터프라이즈 관리자는 네트워크에 미치는 영향을 신중히 분석하고, 명확하게 정의, 승인 및 설정된 프로세스를 참조한 경우에만 트러스트 관계를 삭제하는 것이 좋습니다.
  
다음 표에서는 트러스트 관계 작업을 식별하는 이벤트를 보여 줍니다. 이벤트는 정책 변경 감사 범주에 속합니다.
  
**표 4.11: 트러스트 관계 변경 이벤트**

 
<p> </p>
<table style="border:1px solid black;">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >이벤트 ID</th>
<th style="border:1px solid black;" >발생 동작</th>
<th style="border:1px solid black;" >설명</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">610
611
620</td>
<td style="border:1px solid black;">다른 도메인과의 트러스트 관계가 생성, 삭제 또는 수정됨</td>
<td style="border:1px solid black;">이러한 이벤트는 트러스트된 도메인 개체가 생성되는 도메인 컨트롤러에 나타납니다. 이 이벤트는 경고를 생성해야 하며 즉각적인 조사가 필요합니다. 트러스트 작업을 수행한 주체의 <strong>사용자 이름</strong>을 확인하십시오.</td>
</tr>
</tbody>
</table>
  
#### 보안 정책의 허가되지 않은 변경
  
승인된 보안 구성은 허가된 프로세스와 절차를 통해서만 변경되어야 합니다. 그 밖의 보안 구성 변경은 의도하지 않은 관리자의 실수 또는 고의적인 공격 행위로 간주해야 합니다.
  
정의된 범위 내에서만 변경해야 하는 보안 구성 설정은 다음과 같습니다.
  
-   그룹 정책 설정
  
    -   사용자 계정 암호 정책
  
    -   사용자 계정 잠금 정책
  
    -   감사 정책
  
    -   보안 이벤트 로그에 적용되는 이벤트 로그 설정
  
    -   IPSec 정책
  
    -   무선 네트워크(IEEE 802.11) 정책
  
    -   공개 키 정책(특히 EFS(암호화 파일 시스템)에 적용되는 정책)
  
    -   소프트웨어 제한 정책
  
-   보안 설정
  
    -   사용자 권한 할당
  
    -   사용자 계정 암호 정책
  
    -   보안 옵션
  
이 목록은 최소 요구 사항을 나타내며 대부분의 조직에서 더 많은 그룹 정책 설정을 추가하게 됩니다. 이러한 설정을 변경하려는 모든 시도, 즉 성공한 시도와 실패한 시도를 모두 식별하도록 보안 감사를 구성해야 하며, 성공한 모든 시도는 적절한 권한이 부여된 사용자 계정에 연관되어야 합니다.
  
다음 표에서는 정책(그룹 정책 또는 로컬 시스템 정책) 변경을 식별하는 이벤트를 보여 줍니다. 이벤트는 정책 변경 감사 범주에 속합니다.
  
**표 4.12: 정책 변경 이벤트**

 
<p> </p>
<table style="border:1px solid black;">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >이벤트 ID</th>
<th style="border:1px solid black;" >발생 동작</th>
<th style="border:1px solid black;" >설명</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">612</td>
<td style="border:1px solid black;">감사 정책 변경</td>
<td style="border:1px solid black;">감사 정책 변경을 식별합니다. 허가된 직원이 시스템 정책에 대해 수행한 변경과 이 이벤트와의 연관 관계를 파악하십시오.</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">613
614
615</td>
<td style="border:1px solid black;">IPSec 정책 변경</td>
<td style="border:1px solid black;">이러한 이벤트를 모니터링하고 시스템 시작 이외의 경우에 이러한 이벤트가 발생했는지 조사하십시오.</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">618</td>
<td style="border:1px solid black;">암호화된 데이터 복구 정책</td>
<td style="border:1px solid black;">암호화된 데이터 복구 정책이 사용 중인 경우 이 이벤트를 모니터링하고 발생한 이벤트가 지정된 정책을 위반하지 않았는지 조사하십시오.</td>
</tr>
</tbody>
</table>
  
그룹 정책 설정에 대한 자세한 내용은 [Security Policy Settings (영문)](http://www.microsoft.com/resources/documentation/windowsserv/2003/all/techref/en-us/w2k3tr_sepol_set.asp)을 참조하십시오.
  
[](#mainsection)[페이지 위쪽](#mainsection)
  
### 외부 공격의 식별
  
외부 공격은 사용자의 동작 또는 악의적인 프로그램에 의해 발생합니다. 또한 사용자와 프로그램의 공격이 중복되어 발생할 수 있습니다. 예를 들어 트로이 목마 프로그램이 데스크톱 컴퓨터에 대한 액세스 권한을 얻은 후 사용자가 이러한 권한을 직접 이용할 수 있습니다.
  
외부 공격자는 하나 이상의 컴퓨터에 대한 관리 액세스 권한을 얻을 때까지 권한 승격을 통해 보안을 위배하려고 시도합니다. 이러한 방법을 사용하려면 먼저 제한된 권한을 가진 사용자 계정을 사용하여 침입해야 합니다. 그런 후 공격자는 시스템 컨텍스트에서 실행되는 프로세스나 서비스를 만들어 권한을 승격하려고 시도합니다. 그 다음 암호를 가로채거나 네트워크 패킷을 검색하는 도구와 같은 소프트웨어를 업로드한 후 실행하여 네트워크를 깊숙이 탐색합니다.
  
공격자가 서버에 루트 키트를 설치하려고 할 수도 있습니다. 루트 키트는 컴퓨터를 완전히 제어하며 표준 진단 도구로 그 존재 여부를 확인할 수 없는 소프트웨어 구성 요소입니다. 루트 키트는 아주 낮은 하드웨어 수준에서 작동하므로 시스템 호출을 가로채 수정할 수 있습니다. 루트 키트는 반환된 검색 결과 목록에서 자기 자신을 제거하므로 실행 파일을 검색하는 방법으로는 루트 키트를 찾을 수 없습니다. 루트 키트는 검색 프로그램이 열린 포트를 검색하지 못하게 방해하므로 포트 검색을 수행해도 루트 키트가 사용하는 포트가 열려 있다는 사실을 알 수 없습니다. 따라서 루트 키트를 처리할 때 가장 어려운 점은 루트 키트를 완전히 없앴는지 확인하는 것입니다.
  
트로이 목마 응용 프로그램은 루트 키트보다 더 해로울 수 있지만 감지하기는 보다 쉽습니다. 트로이 목마 프로그램은 루트 키트와 비슷한 원격 제어 기능을 제공하거나 바이러스와 같이 단순히 데이터를 파괴할 수 있습니다. 트로이 목마 프로그램만의 독특한 기능은 이름에서 알 수 있듯이 실제 트로이 목마와 같이 유용한 프로그램인 것처럼 사용자를 속여 실행하도록 만드는 것입니다.
  
대부분의 악의적인 프로그램은 사람이 직접 주도하는 공격만큼 유연하거나 민감하게 반응하지 않습니다. 그러나 전자 메일과 같이 주변 네트워크를 우회하는 바이러스 전달 메커니즘에는 특히 주의해야 합니다. 엄격한 전자 메일 첨부 파일 필터를 사용하면 이러한 종류의 공격을 줄일 수 있습니다.
  
외부 공격에는 다음과 같은 범주가 포함됩니다.
  
-   자격 증명 도용
  
-   취약점 악용
  
-   루트 키트 또는 트로이 목마 설치
  
-   사용자가 악의적 프로그램을 실행하도록 유도
  
-   허가되지 않은 컴퓨터 액세스
  
#### 자격 증명 도용
  
공격자는 사용자 계정 자격 증명을 얻기 위해 몇 가지 방법을 사용합니다. 가장 잘 알려진 방법은 단일 사용자 계정을 사전 공격의 대상으로 삼는 것입니다. 이 경우 공격자는 하나의 사용자 계정 이름만 압니다. 또 다른 방법은 디렉터리 서비스 데이터베이스에 포함되어 있는 모든 사용자 계정에 동일한 암호 집합을 적용하는 것입니다. 두 번째 경우 공격자는 조직의 디렉터리 서비스에 액세스할 수 있습니다. 이러한 두 번째 공격을 감지하려면 총 로그온 시도 횟수가 계정 잠금 임계값보다 적은 경우에도 일련의 계정에 대해 계정 잠금 및 여러 번 실패한 로그온 시도를 모니터링할 수 있어야 합니다.
  
사용자의 로그온 정보를 얻는 또 다른 방법으로 암호 변경 또는 암호 다시 설정이 있습니다. 암호를 변경하거나 다시 설정하면 성공 및 실패 둘 모두에 대해 동일한 이벤트가 생성되므로 공격자가 계정 잠금 정책을 우회하여 탐지를 피할 수 있습니다. 보안 모니터링 솔루션은 여러 번의 암호 변경 또는 다시 설정 시도, 특히 이와 관련된 조직의 정책에 위배되는 암호 변경 또는 다시 설정 시도를 식별해야 합니다.
  
암호 순환은 공격은 아니지만 사용자가 시작한 스크립트를 통해 암호가 여러 번 변경된 후 이전에 사용했던 암호로 되돌아가게 되는 경우에 발생합니다. 암호 변경 시도 횟수는 암호 다시 사용 임계값과 같습니다. 이 시나리오에서는 기본 계정 이름이 대상 계정 이름과 같은 627 이벤트가 빠르게 연속 발생합니다. 최소 암호 사용 기간을 지정하면 이러한 암호 변경 시도가 실패합니다.
  
다음 표에서는 사용자 자격 증명을 대상으로 하는 공격으로 인해 발생하는 이벤트를 보여 줍니다. 그러나 이러한 이벤트는 일반적인 네트워크 작업으로 인해 발생하거나 합법적인 사용자가 암호를 잊어버린 경우에 발생할 수도 있습니다.
  
**표 4.13: 인증 자격 증명 공격 이벤트**

 
<p> </p>
<table style="border:1px solid black;">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >이벤트 ID</th>
<th style="border:1px solid black;" >발생 동작</th>
<th style="border:1px solid black;" >설명</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">529</td>
<td style="border:1px solid black;">로그온 실패 — 알 수 없는 사용자 이름 또는 암호</td>
<td style="border:1px solid black;"><strong>대상 계정 이름</strong>이 Administrator 또는 이름이 바뀐 기본 관리자 계정과 같은지 확인하십시오. 여러 번 실패한 로그온 시도 중 계정 잠금 임계값보다 적게 시도한 경우를 확인하십시오. 이 이벤트는 허가되지 않은 개인이 로컬 관리자 암호를 추측하려고 시도했음을 나타낼 수 있습니다. 이벤트 529와 이벤트 539와의 연관 관계를 파악하여 연속되는 계정 잠금의 패턴을 식별하십시오.</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">534</td>
<td style="border:1px solid black;">로그온 실패 — 허용되지 않는 로그온 유형</td>
<td style="border:1px solid black;">사용자가 네트워크, 대화형, 일괄 또는 서비스와 같이 허용되지 않는 로그온 유형을 사용하여 로그온을 시도했습니다. <strong>대상 계정 이름</strong>, <strong>워크스테이션 이름</strong> 및 <strong>로그온 유형</strong>을 확인하십시오.</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">539</td>
<td style="border:1px solid black;">계정이 잠김</td>
<td style="border:1px solid black;">사용자가 이미 잠겨 있는 계정에 로그온하려고 했습니다. 이벤트 529와의 연관 관계를 파악하여 연속되는 잠금의 패턴을 감지하십시오.</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">553</td>
<td style="border:1px solid black;">재생 공격 탐지</td>
<td style="border:1px solid black;">이 이벤트는 인증 패키지(보통 Kerberos)가 사용자의 자격 증명 재생을 통한 로그온 시도를 탐지했을 때 발생합니다. 즉시 조사하십시오. 또는 네트워크 구성이 잘못되었음을 나타낼 수도 있습니다.</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">627</td>
<td style="border:1px solid black;">암호 변경 시도</td>
<td style="border:1px solid black;"><strong>기본 계정 이름</strong>과 <strong>대상 계정 이름</strong>을 비교하여 계정 소유자나 다른 사용자가 계정 암호 변경을 시도했는지 확인하십시오. <strong>기본 계정 이름</strong>이 <strong>대상 계정 이름</strong>과 다르면 계정 소유자 이외의 누군가가 암호를 변경하려고 한 것입니다.</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">628</td>
<td style="border:1px solid black;">사용자 계정 암호 설정 또는 다시 설정</td>
<td style="border:1px solid black;">이 작업은 지원 부서 또는 사용자 셀프 서비스 암호 다시 설정과 같이 허가된 사람이나 프로세스만 수행해야 합니다. 이러한 경우가 아니면 이 이벤트를 즉시 조사하십시오.</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">644</td>
<td style="border:1px solid black;">사용자 계정이 자동으로 잠김</td>
<td style="border:1px solid black;">연속으로 실패한 로그온 시도 횟수가 계정 잠금 제한보다 많아서 사용자 계정이 잠겼습니다. 이 이벤트와 이벤트 529, 675, 676(Windows 2000 Server에만 해당), 681과의 연관 관계를 파악하십시오. 이 표에서 이벤트 12294에 대한 항목도 참조하십시오.</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">675</td>
<td style="border:1px solid black;">사전 인증 실패</td>
<td style="border:1px solid black;">이벤트 529와의 연관 관계를 파악하여 로그온 실패에 대한 추가 원인을 찾으십시오. 가능한 원인에는 시간 동기화 문제 또는 도메인에 제대로 가입하지 않은 컴퓨터 계정인 경우 등이 있습니다.</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">12294</td>
<td style="border:1px solid black;">계정 잠금 시도</td>
<td style="border:1px solid black;">이 이벤트는 기본 Administrator 계정에 대한 무차별 대입(Brute Force) 공격의 가능성을 나타냅니다. 이 계정은 잠기지 않으므로 시스템 이벤트 로그는 대신 SAM 이벤트 12294를 기록합니다. 이 이벤트가 한 번만 발생해도 허가되지 않은 운영 체제가 있는 것이므로 즉시 조사해야 합니다. <strong>도메인 이름</strong> 필드에 알 수 없는 도메인이 있는지 확인하십시오.</td>
</tr>
</tbody>
</table>
  
#### 취약점 악용
  
어떠한 컴퓨터에서나 취약점은 있으므로 공격자는 이러한 취약점을 악용하여 조직의 네트워크에 침투하려고 합니다. 취약점을 악용하려는 공격자로부터 보호하는 가장 좋은 방법은 Microsoft Systems Management Server 2003 또는 Microsoft Software Update Services를 사용하는 효과적인 패치 관리 프로세스를 정의하는 것입니다.
  
패치 관리에 대한 자세한 내용은 [Patch Management Using Systems Management Server 2003 (영문)](http://www.microsoft.com/downloads/details.aspx?familyid=e9eab1bd-13e7-4e25-85c5-ce2d191c3d63) 및 [Patch Management Using Software Update Services (영문)](http://www.microsoft.com/downloads/details.aspx?familyid=38d7e99b-e780-43e5-aa84-cdf6450d8f99)을 참조하십시오.
  
주변 네트워크의 컴퓨터는 공격자의 공격을 받을 가능성이 가장 높으므로 보안 모니터링이 특히 중요합니다. 공격 받고 있음을 탐지하기 위한 메커니즘이 없다면 공격자가 네트워크를 손상시킬 때까지 문제를 알지 못할 수도 있습니다. 그러므로 주변 네트워크의 컴퓨터에 대한 보안 모니터링은 여러 이벤트를 탐지할 수 있어야 합니다.
  
일반적으로 보안 취약점은 무단 액세스를 시도하거나 권한이 있는 ID를 사용하는 등의 방식으로 악용됩니다. 다음 표에서는 컴퓨터에 대한 공격 가능성을 식별하는 데 도움이 되는 몇 가지 이벤트를 보여 줍니다.
  
**참고:  **이러한 종류의 공격을 식별할 수 있는 다른 이벤트를 보려면 표 4.13, "인증 자격 증명 공격 이벤트"를 참조하십시오.
  
**표 4.14: 권한을 승격하여 취약점을 악용한 경우를 식별할 수 있는 이벤트**

 
<p> </p>
<table style="border:1px solid black;">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >이벤트 ID</th>
<th style="border:1px solid black;" >발생 동작</th>
<th style="border:1px solid black;" >설명</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">528
538</td>
<td style="border:1px solid black;">로컬 로그온 및 로그오프</td>
<td style="border:1px solid black;">주변 컴퓨터에서는 로컬 로그온이 거의 발생하지 않습니다. 로그온 ID 필드의 연관 관계를 파악하십시오. <strong>사용자 계정 이름</strong>, <strong>시간</strong> 또는 <strong>워크스테이션</strong> 이름 값이 올바른지 확인하십시오.</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">576</td>
<td style="border:1px solid black;">권한 있는 로그온</td>
<td style="border:1px solid black;"><strong> </strong>Windows Server 2003 SP1 이상에서 이 이벤트는 &quot;관리자&quot; 로그온, 즉 TCB(Trusted Computing Base)를 임의로 변경하거나 컴퓨터 작업을 인계받을 수 있는 충분한 권한이 있는 로그온을 나타냅니다. 이전 버전의 Windows에서는 <strong>SeSecurityPrivilege</strong> 또는 <strong>SeDebugPrivilege</strong>와 같은 중요한 권한이 포함된 경우에만 이 이벤트가 중요하게 인식됩니다.</td>
</tr>
</tbody>
</table>
  
**참고:**  Windows Server 2003 이전 버전에서는 이벤트 576이 권한 사용 범주에 포함됩니다. Windows Server 2003 이상에서는 이 이벤트가 로그온 범주에도 포함됩니다. 따라서 둘 중 어느 한 범주에 대한 감사 설정을 구성하면 이 이벤트가 발생합니다.
  
#### 루트 키트 또는 트로이 목마 설치
  
보안 모니터링을 통해 루트 키트의 설치를 탐지하는 것은 어려운 일이지만 불가능하지는 않습니다. 연속적으로 빠르게 시작 및 중지되는 알 수 없는 프로그램은 루트 키트일 가능성이 높습니다. 일단 루트 키트가 시작되면 운영 체제는 더 이상 루트 키트를 감지할 수 없습니다. 따라서 프로그램이 종료된 것처럼 나타나며 추가 이벤트가 생성되지 않습니다.
  
트로이 목마 프로그램은 루트 키트와 같은 은폐 특성이 없으므로 일반적으로 루트 키트보다 쉽게 식별할 수 있습니다. 키 입력 로거(키 입력을 기록하는 프로그램) 또한 이 범주에 속합니다.
  
다음 표에서는 루트 키트를 설치할 경우 발생할 수 있는 이벤트를 보여 줍니다.
  
**표 4.15: 루트 키트 또는 트로이 목마 이벤트**

 
<p> </p>
<table style="border:1px solid black;">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >이벤트 ID</th>
<th style="border:1px solid black;" >발생 동작</th>
<th style="border:1px solid black;" >설명</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">592</td>
<td style="border:1px solid black;">새 프로세스 만들기</td>
<td style="border:1px solid black;">새 프로세스의 <strong>이미지 파일 이름</strong>과 <strong>사용자 이름</strong>을 확인하십시오. 모든 프로세스는 허가된 프로그램이어야 합니다.</td>
</tr>
</tbody>
</table>
  
#### 사용자가 악의적 프로그램을 실행하도록 유도
  
이 방법의 경우 공격자는 방화벽과 주변 네트워크를 우회하여 사용자에게 실행 첨부 파일을 전달하려고 시도합니다. 전자 메일이 가장 일반적인 전달 메커니즘이지만 감염된 웹 사이트 등에 연결할 경우에도 같은 결과가 발생할 수 있습니다.
  
공격자의 첫 번째 과제는 사용자가 프로그램을 실행하도록 유도하는 것입니다. 사용자가 프로그램을 실행하면 사용자의 보안 컨텍스트에서 프로그램이 시작됩니다. 그런 후 프로그램은 관리자와 동일한 권한을 얻거나 네트워크 액세스 권한을 얻는 등 권한을 승격하려고 시도합니다.
  
프로그램 시작 시도를 탐지하도록 프로세스 추적을 구성할 수 있습니다. 사용자가 실행할 수 있는 프로그램을 제한하는 소프트웨어 제한 정책이 설정된 상태에서 허가되지 않은 프로그램을 시작하려고 하면 조사가 필요한 감사 실패 이벤트가 발생합니다. 다음 이벤트가 발생할 경우에 특히 주의해야 합니다.
  
-   **LocalSystem으로 생성된 프로세스.** LocalSystem으로 실행되는 프로세스는 **services.exe**와 같은 잘 정의된 서비스 실행 파일이어야 합니다. 일부 다른 실행 이미지가 있음을 나타내는 이벤트 592가 발생하면 추가 조사가 필요합니다.
  
-   **예상치 못한 시간에 생성된 프로세스.** 컴퓨터에서 백업, CGI 또는 스크립트와 같은 예약된 일괄 프로세스를 사용하지 않는 경우 야간 등 특별한 시간에 발생한 프로세스에 대해 추가 조사가 필요합니다. 이벤트 592가 발생한 경우를 찾으십시오.
  
표 4.15, "루트 키트 또는 트로이 목마 이벤트"에서는 공격자가 사용자를 속여 악의적인 응용 프로그램을 시작하도록 유도할 때 발생할 수 있는 이벤트를 나열합니다.
  
#### 허가되지 않은 컴퓨터 액세스
  
관리자는 터미널 서비스와 같은 원격 관리 기능을 사용하여 특정 컴퓨터에 연결하는 경우가 점점 더 많아지게 됩니다. 따라서 이러한 컴퓨터에서 대화형 로그온 시도가 있는지 모니터링하고 연결 시도가 유효한지 확인해야 합니다. 다음과 같은 사항을 확인해야 합니다.
  
-   서비스 계정을 사용하는 로그온 식별
  
-   허가되지 않은 계정을 사용하여 서버에 액세스하려는 시도 기록
  
-   예상치 못한 지역에서 서버에 액세스하려는 시도 확인
  
-   외부 IP 주소 범위에서 서버에 액세스하려는 시도 나열
  
이러한 유형의 모니터링은 재무 또는 고객 기록과 같은 고가치 자산의 경우 특히 중요합니다. 중요한 리소스는 별도의 서버에 두고 해당 리소스에 액세스하는 사용자를 엄격히 제어하는 정책을 설정해야 합니다.
  
보안 모니터링을 통해 이러한 컴퓨터에 연결을 시도하는 사용자를 확인할 수 있어야 하며, 이 사용자 정보와 허용되는 사용자 목록을 서로 비교해야 합니다. 다음 표에서는 허가되지 않은 컴퓨터가 사용될 때 발생하는 이벤트를 보여 줍니다.
  
**표 4.16: 허가되지 않은 컴퓨터 사용 이벤트**

 
<p> </p>
<table style="border:1px solid black;">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >이벤트 ID</th>
<th style="border:1px solid black;" >발생 동작</th>
<th style="border:1px solid black;" >설명</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">528</td>
<td style="border:1px solid black;">로그온 성공</td>
<td style="border:1px solid black;">워크스테이션 <strong>이름</strong>을 확인한 후 <strong>사용자 계정 이름</strong>을 확인하십시오. <strong>원본 네트워크 주소</strong>가 조직의 IP 주소 범위 내에 있는지 확인하십시오.</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">530</td>
<td style="border:1px solid black;">로그온 실패 — 시간 제한</td>
<td style="border:1px solid black;">이 이벤트는 로그온 시도가 허용되는 시간을 벗어났음을 나타냅니다. <strong>사용자 계정 이름</strong>과 <strong>워크스테이션 이름</strong>을 확인하십시오.</td>
</tr>
</tbody>
</table>
  
[](#mainsection)[페이지 위쪽](#mainsection)
  
### 법적 분석의 구현
  
3장, "문제 및 요구 사항"에서는 법적 분석이 정책 위반의 탐지 및 외부 공격의 식별과 근본적으로 어떻게 다른지 보여 줍니다. 법적 분석은 이 가이드에서 이미 다루어진 많은 요소를 사용하여 수행되지만 결과 데이터의 분석과 장기적인 저장에 중점을 둡니다. 대부분의 법적 조사는 "사용자 A에 대한 모든 이벤트 나열" 또는 "컴퓨터 B의 모든 이벤트 나열"의 두 가지 유형으로 진행됩니다.
  
법적 분석을 위한 보안 모니터링을 수행하려면 다음 작업이 필요합니다.
  
-   보관할 이벤트 유형을 선택합니다.
  
-   매일 예상되는 이벤트의 수를 계산합니다.
  
-   온라인, 오프라인 및 보관 저장소의 시간 제한을 결정합니다.
  
-   예상되는 이벤트 수를 처리할 수 있도록 온라인 데이터베이스를 확장합니다.
  
-   예상되는 일별 이벤트 로드를 처리할 수 있는 백업 시스템을 지정합니다.
  
-   보관 시스템의 관리 방법을 결정합니다.
  
다음의 세 가지 주요 요인에 따라 저장소 요구 사항이 결정됩니다.
  
-   기록해야 하는 이벤트의 수
  
-   대상 컴퓨터가 이러한 이벤트를 생성하는 속도
  
-   이 정보의 온라인 사용을 가능하게 하는 데 필요한 시간
  
**참고:** 개체액세스를 제외하고 모든 감사 범주가 설정된 도메인 컨트롤러는 시간당 약 3,000개의 보안 이벤트를 생성할 수 있습니다. 이 정보를 Event Comb MT에서 .CSV 파일로 저장하면 1MB 크기의 파일이 만들어집니다. 개체 액세스 감사 및 프로세스 추적을 사용하면 이러한 파일 크기가 크게 증가할 수 있습니다.
  
분석한 결과 비현실적인 저장소 요구 사항이 산출될 수도 있습니다. 이 경우 모니터링 대상 컴퓨터의 수, 모니터링하는 이벤트, 오프라인 저장소로 다시 배치하기 전에 이러한 이벤트가 온라인으로 저장되는 기간 등을 적절히 고려해야 합니다.
  
이 가이드의 부록 A, "불필요한 이벤트 제외"에서는 유용한 정보를 제공하지 않는 이벤트에 대해 설명합니다. 이 부록은 유용한 보안 정보를 제공하지 않는 이벤트를 제외시키는 데 도움이 됩니다.
  
[](#mainsection)[페이지 위쪽](#mainsection)
  
### 요약
  
효과적인 보안 모니터링 및 공격 탐지 시스템은 네트워크 무결성의 유지 관리에 필수적인 구성 요소입니다. Windows 보안 감사를 기반으로 모니터링 및 공격 탐지 솔루션을 계획하려면 시스템의 목표를 포괄적으로 이해해야 합니다. 또한 네트워크에서 발생하기 쉬운 위협 및 각 위협 유형과 관련된 공격 징후를 잘 파악해야 합니다.
  
Windows Server 2003에서는 보안 모니터링 및 보안 로깅을 사용하는 공격 탐지 시스템의 기본 구성 요소를 제공합니다. Microsoft에서는 Microsoft Operations Manager와 같은 서버 기반 구성 요소와, Event Comb MT와 같이 여러 컴퓨터의 이벤트 로그 간의 연관 관계를 파악하고 보안 이벤트의 분석을 제공하는 유틸리티를 제공합니다. Microsoft 파트너는 공격 프로필을 빠르게 식별할 수 있도록 하는 추가 도구와 유틸리티를 제공합니다.
  
[](#mainsection)[페이지 위쪽](#mainsection)
  
##### 다운로드
  
[![](images/Dd547936.icon_exe(ko-kr,TechNet.10).gif)](http://go.microsoft.com/fwlink/?linkid=41310)[보안 모니터링 및 공격 탐지 계획 가이드 (영문)](http://go.microsoft.com/fwlink/?linkid=41310)
  
[](#mainsection)[페이지 위쪽](#mainsection)
