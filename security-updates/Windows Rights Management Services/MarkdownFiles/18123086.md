---
TOCTitle: 로깅 데이터베이스 유지 관리
Title: 로깅 데이터베이스 유지 관리
ms:assetid: 'de55058b-0d1a-4997-8a45-e14678ddd13f'
ms:contentKeyID: 18123086
ms:mtpsurl: 'https://technet.microsoft.com/ko-kr/library/Cc747691(v=WS.10)'
---

로깅 데이터베이스 유지 관리
===========================

로그 항목은 사용자 등록 및 사용 라이센스 할당과 같은 다양한 RMS 작업을 위해 발급된 라이센스의 복사본도 포함합니다. 모든 로그 항목이 성공적인 사용자 등록이거나 성공적인 사용 라이센스 취득 시도인 최악의 시나리오에서 각 로그 항목은 로깅 데이터베이스 크기에 약 200 KB를 추가할 수 있습니다.

예를 들어 사용자 수가 50,000명인 회사 내의 모든 직원에게 RMS로 보호된 전자 메일 메시지를 보냈고 모든 직원이 해당 메시지를 열어 본다고 가정합니다. 각 직원이 하루 동안 이 전자 메일 메시지를 연 경우 로깅 데이터베이스는 10GB까지 증가합니다. 실제 XML 데이터를 기록하지 않도록 수신 서비스를 구성하여 기록되는 정보의 양을 줄일 수 있습니다.

로깅 데이터베이스의 이전 정보를 보조 데이터베이스에 보관하는 스크립트를 만듭니다. 로깅 스크립트 예제는 [Microsoft 웹 사이트](http://go.microsoft.com/fwlink/?linkid=26724)(http://go.microsoft.com/fwlink/?LinkId=26724)에서 무료로 다운로드할 수 있는 RMS Toolkit에서 사용할 수 있습니다.

로깅 데이터베이스 증가에 영향을 주는 변수
-----------------------------------------

로깅 데이터베이스의 크기 예측은 환경에 따라 다릅니다. 다음을 포함하여 로그 내의 많은 "시작" 항목을 예측할 수 있습니다.

-   RMS 서버 등록
-   사용자 등록(각 사용자가 사용하는 컴퓨터별로 고유한 요청)
-   오프라인 게시 인증서에 대한 자동화된 사용자 요청

최초 시작 이후 로깅 데이터베이스 내의 많은 항목이 보호된 콘텐츠에 대한 사용 라이센스 발급에 관련됩니다. 다음과 같은 많은 조건이 이 데이터베이스의 증가에 영향을 미칩니다.

-   사용자가 보호된 콘텐츠에 액세스할 때마다 새 라이센스 요구. 이는 보호된 문서에 대한 기본 방법이 아니라 옵션 설정입니다. 이 요구 사항을 구현하면 데이터베이스가 더 빠른 속도로 증가합니다.
-   매일 각 사용자에게 보내는 보호된 전자 메일 메시지의 예상 수.
-   이러한 보호된 전자 메일 메시지를 읽을 고유 사용자의 예상 수.
-   각 사용자가 매일 생성하는 보호된 Microsoft Office 2003(Word, PowerPoint, Excel 등) 문서의 예상 수.
-   보호된 문서의 예상 받는 사람.

로깅 데이터베이스의 최초 크기는 약 1.7 MB이며 RMS 서버의 인증서 요청을 포함합니다. 새 사용자는 등록할 때마다 RAC(권한 계정 인증서) 및 CLC(클라이언트 사용 허가자 인증서)를 얻습니다. 이러한 두 작업은 기록되고 두 작업 간에 데이터베이스가 0.06 MB 증가합니다. 사용자가 보호된 콘텐츠에 대한 라이센스를 취득할 때마다 데이터베이스가 0.19 MB 증가합니다.

이 예측 방법을 고려하려면 사용자가 5,000명인 조직에서 모든 사용자가 사용할 RMS를 배포한다고 간주합니다. 사용자마다 한 대의 컴퓨터를 사용하고 조직에서 두 대의 RMS 서버를 사용합니다. 배포 후에 각 사용자는 평균적으로 매일 하나의 RMS로 보호된 전자 메일 메시지를 만들어 5명의 다른 사용자에게 보냅니다. 또한, 각 사용자는 매일 하나의 RMS로 보호된 문서를 만들고 이 문서에는 세 명의 다른 사용자가 액세스합니다. 다음 표에서는 이 작업으로 인해 로깅 데이터베이스가 증가하는 크기를 예상합니다.

###  

 
<table style="border:1px solid black;">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th>작업</th>
<th>로그 증가</th>
<th>누적 로그 크기</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">RMS 서버가 성공적으로 구축되었습니다.</td>
<td style="border:1px solid black;">1.7 MB</td>
<td style="border:1px solid black;">1.7 MB</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">5000명의 직원 등록(5000*0.06)</td>
<td style="border:1px solid black;">300 MB</td>
<td style="border:1px solid black;">301.7 MB</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">보호된 전자 메일 메시지에 액세스됨(25000*0.19)</td>
<td style="border:1px solid black;">4,750 MB</td>
<td style="border:1px solid black;">5,051.7 MB</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">보호된 문서에 액세스됨(15000*0.19)</td>
<td style="border:1px solid black;">2,850 MB</td>
<td style="border:1px solid black;">7,901.7 MB</td>
</tr>
</tbody>
</table>
  
따라서, 등록 후에 로깅 데이터베이스는 약 300MB의 정적 크기를 가집니다. 그러나, 이 예에서는 매일 7.6 GB(기본 메시지 큐 설치의 8 GB 제한에 가까움)씩 증가합니다. 로깅 데이터베이스를 더 이상 사용할 수 없는 경우 로그 항목이 손실됩니다.
  
로깅 데이터베이스 크기 제어  
---------------------------
  
배포 계획은 로깅 데이터베이스 관리 방법을 포함해야 합니다. 다음은 가장 일반적인 방법입니다.
  
-   **잘라내기 및 보관**  
    이 방법에서는 로그 항목이 특정 기간에 도달할 경우 SQL Server 스크립트를 사용하여 로깅 데이터베이스에서 선택한 정보를 보조 데이터베이스에 보관합니다. 또한, 공간이 낭비되지 않도록 데이터베이스에서 부적절한 정보를 필터링합니다.  
-   **기록되는 정보 제한**  
    로깅 데이터베이스는 다음과 같은 세 가지 기본 테이블로 구성됩니다. 하나는 **DRMS\_Log\_Filter**이며 로그 필터링을 사용할 때 기록될 마스터 테이블의 필드를 식별합니다.  
    on/off 테이블 항목은 RMS 서버의 로깅 수신 서비스에서 실제로 기록되는 마스터 테이블의 필드를 지정합니다. XrML과 관련된 이러한 필드 중 두 개는 로깅을 사용할 수 없도록 이미 0으로 설정되어 있습니다. 이러한 두 필드는 각 라이센스 요청 행 크기의 약 99%를 차지합니다.  
    **DRMS\_Config\_ServerName\_Port** 데이터베이스 아래의 **DRMS\_ClusterPolicies** 테이블에는 **LoggingFiltering**의 **PolicyName**을 포함합니다. **LoggingFiltering**은 기본적으로 사용되지 않습니다. **LoggingFiltering** 값을 1로 변경하고 로깅 수신 서비스를 다시 시작하면 앞에서 설명한 예제의 일일 데이터베이스 증가가 7.6 GB에서 약 160 MB로 감소됩니다.  
-   **로깅 데이터베이스 이동**  
    증가하는 로깅 데이터베이스를 관리하는 다른 옵션으로 데이터베이스를 디스크 공간이 더 많은 서버로 이동하면 됩니다. 로깅 데이터베이스는 구성 데이터베이스와 다른 데이터베이스 서버에 존재할 수 있습니다. 데이터베이스를 다른 서버로 이동하려면 다음 단계를 수행합니다.  
    1.  각 RMS 서버에 대한 로깅 수신 서비스를 중지합니다.  
    2.  다른 서버에서 데이터베이스를 복사하거나 새 데이터베이스를 만듭니다.  
    3.  **DRMS\_ClusterPolicies** 테이블을 선택하고 **LoggingDatabaseName**(데이터베이스 서버 이름) 및 **LoggingDatabaseServer**(데이터베이스 이름)의 값을 편집하여 RMS **DRMS\_Config\_ServerName\_Port** 데이터베이스를 편집합니다.  
    4.  명령줄에서 IISRESET.exe를 실행하여 IIS를 다시 시작합니다.
